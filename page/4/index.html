<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css">




  
  
  
  

  

  

  

  

  

  
    

    
  

  
    
    
    <link href="//fonts.cat.net/css?family=Sigmar One:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css">



  

<link href="https://cdn.bootcss.com/social-share.js/1.0.9/css/share.min.css" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=0.0.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=0.0.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=0.0.4">


  <link rel="mask-icon" href="/images/logo.svg?v=0.0.4" color="#222">





  <meta name="keywords" content="blog">










<meta property="og:type" content="website">
<meta property="og:title" content="Keep Coding">
<meta property="og:url" content="https://wuchao.github.io/page/4/index.html">
<meta property="og:site_name" content="Keep Coding">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Keep Coding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '0.0.4',
    sidebar: {"position":"right","display":"always","offset":52,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    since: '8/10/2019 20:40:00',
    onlineAPI: '',
    site: {
      title: 'Keep Coding',
      subtitle: '',
      author: 'wuchao'
    },
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    leancloud: {
      enable: false,
      appID: '',
      appKey: ''
    },
    favicon: {
      visibilitychange: true,
      narmal: '/images/favicon.ico',
      hidden: '/images/failure.ico',
      show_text: '(/≧▽≦/)咦！又好了！',
      hide_text: '(●—●)喔哟，崩溃啦！'
    }
  };
</script>



  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>




  <link rel="canonical" href="https://wuchao.github.io/page/4/">





  <title>Keep Coding</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-48084758-7', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
      <li class="menu-item search">
          <form class="search-form">
            <input name="keyword" type="text" class="search-input" placeholder="站内搜索">
            <button type="submit" class="search-submit"><i class="fa fa-search"></i></button>
          </form>
      </li>
    </ul>
  

  
</nav>

<div class="site-brand-wrapper" style="background-image: url(/images/header-sagiri.jpg)">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <div class="brand">
        <span class="logo-line-before"><i></i></span>
        <div class="site-title">
          <div id="animate" class="animate">
            <span>K</span><span>e</span><span>e</span><span>p</span><span> </span><span>C</span><span>o</span><span>d</span><span>i</span><span>n</span><span>g</span>
          </div>
          <div id="guide" class="guide">
            <span>K</span><span>e</span><span>e</span><span>p</span><span> </span><span>C</span><span>o</span><span>d</span><span>i</span><span>n</span><span>g</span>
          </div>
        </div>
        <span class="logo-line-after"><i></i></span>
      </div>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">29</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/JS-JQuery/" itemprop="url" rel="index">
          <span itemprop="name">JS/JQuery</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/29/js-2018-01-29-modal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/29/js-2018-01-29-modal/" itemprop="url">Bootstrap 模态框</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-29T00:00:00+08:00">
                2018-01-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JS-JQuery/" itemprop="url" rel="index">
                    <span itemprop="name">JS/JQuery</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>判断页面某个模态框是否显示或隐藏：</p>
<pre><code>var modal_status = 0;//默认0， 0表示隐藏

$(&apos;#myModal&apos;).on(&apos;show.bs.modal&apos;, function (e) {
`modal_status = 1; // 1表示显示
})

$(&apos;#myModal&apos;).on(&apos;hidden.bs.modal&apos;, function (e) {
`modal_status = 0;
})</code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/29/js-2018-01-29-modal/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">29</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Mybatis/" itemprop="url" rel="index">
          <span itemprop="name">Mybatis</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/29/mybatis-2018-01-29-Mybatis-Statement/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/29/mybatis-2018-01-29-Mybatis-Statement/" itemprop="url">Mybatis 语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-29T00:00:00+08:00">
                2018-01-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="批量操作："><a href="#批量操作：" class="headerlink" title="批量操作："></a>批量操作：</h3><blockquote>
<p><a href="http://www.jb51.net/article/99134.htm" target="_blank" rel="noopener">Mybatis 插入和删除批处理操作</a>  </p>
<p><a href="https://www.cnblogs.com/digdeep/p/4589037.html" target="_blank" rel="noopener">springMVC 接收数组参数，mybatis 接收数组参数，mybatis批量插入/批量删除案例</a></p>
<p><a href="https://www.cnblogs.com/prefect/p/5746624.html" target="_blank" rel="noopener">SQL中的case when then else end用法</a> </p>
</blockquote>
<p>批量 insert： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=&quot;batchSaveOrUpdate&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;</span><br><span class="line">    INSERT INTO favorite_group(id, name, user_id) VALUES</span><br><span class="line">    &lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">        (#&#123;item.id&#125;, #&#123;item.name&#125;, #&#123;item.userId&#125;)</span><br><span class="line">    &lt;/foreach&gt;</span><br><span class="line">&lt;/insert&gt;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">最终的语句类似：  </span><br><span class="line"></span><br><span class="line">```  </span><br><span class="line">insert into favorite_group(id, name, user_id) values (1, 1, 1), (2, 2, 2), (3, 3, 3)</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/29/mybatis-2018-01-29-Mybatis-Statement/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">17</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/JS-JQuery/" itemprop="url" rel="index">
          <span itemprop="name">JS/JQuery</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/17/js-2018-01-17-js-map/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/17/js-2018-01-17-js-map/" itemprop="url">JS 中的 map</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-17T00:00:00+08:00">
                2018-01-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JS-JQuery/" itemprop="url" rel="index">
                    <span itemprop="name">JS/JQuery</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p><a href="http://blog.csdn.net/dqswuyundong/article/details/52754191" target="_blank" rel="noopener">js 中使用map和java HashMap 对比</a> </p>
</blockquote>
<p>方式一</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var map = &#123;&#125;; // Map map = new HashMap();</span><br><span class="line">map[key] = value; // map.put(key, value);</span><br><span class="line">var value = map[key]; // Object value = map.get(key);</span><br><span class="line">var has = key in map; // boolean has = map.containsKey(key);</span><br><span class="line">delete map[key]; // map.remove(key);</span><br><span class="line">// 遍历  </span><br><span class="line">for(key in map)&#123;  </span><br><span class="line">    alert(key + map[key]);  </span><br><span class="line">&#125;  </span><br><span class="line">//长度判断</span><br><span class="line">var length  = Object.keys(map).length ;</span><br></pre></td></tr></table></figure>

<p>方式二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var map=&#123;&#125;;</span><br><span class="line"></span><br><span class="line">map.name=&apos;张三&apos;;</span><br><span class="line"></span><br><span class="line">map.age=34;</span><br><span class="line"></span><br><span class="line">var name=map.name;</span><br><span class="line"></span><br><span class="line">var has = key in map;</span><br><span class="line"></span><br><span class="line">delete map[key];</span><br><span class="line"></span><br><span class="line">$.each(m,function(key,val)&#123;</span><br><span class="line">alert(key+&apos;   &apos;+val);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/17/js-2018-01-17-js-map/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">08</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Mybatis/" itemprop="url" rel="index">
          <span itemprop="name">Mybatis</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/08/mybatis-2018-01-08-Mybatis-Configuration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/08/mybatis-2018-01-08-Mybatis-Configuration/" itemprop="url">Mybatis 的配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T00:00:00+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="使用-XML-配置-MyBatis"><a href="#使用-XML-配置-MyBatis" class="headerlink" title="使用 XML 配置 MyBatis"></a>使用 XML 配置 MyBatis</h2><p>构建 SqlSessionFactory 最常见的方式是基于 XML 配置（的构造方式）。下面的 mybatis-config.xml 展示了一个典型的 MyBatis 配置文件的样子： </p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;  
&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;  
&lt;configuration&gt;  
  &lt;properties resource=&quot;application.properties&quot;&gt;  
    &lt;property name=&quot;username&quot; value=&quot;db_user&quot; /&gt;  
    &lt;property name=&quot;password&quot; value=&quot;verysecurepwd&quot; /&gt;  
  &lt;/properties&gt;  
  &lt;settings&gt;  
    &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot; /&gt;  
  &lt;/settings&gt;  
  &lt;typeAliases&gt;  
    &lt;typeAlias alias=&quot;Tutor&quot; type=&quot;com.mybatis3.domain.Tutor&quot; /&gt;  
    &lt;package name=&quot;com.mybatis3.domain&quot; /&gt;  
  &lt;/typeAliases&gt;  
  &lt;typeHandlers&gt;  
    &lt;typeHandler handler=&quot;com.mybatis3.typehandlers. PhoneTypeHandler&quot; /&gt;  
    &lt;package name=&quot;com.mybatis3.typehandlers&quot; /&gt;  
  &lt;/typeHandlers&gt;  
  &lt;environments default=&quot;development&quot;&gt;  
    &lt;environment id=&quot;development&quot;&gt;  
      &lt;transactionManager type=&quot;JDBC&quot; /&gt;  
      &lt;dataSource type=&quot;POOLED&quot;&gt;  
        &lt;property name=&quot;driver&quot; value=&quot;${jdbc.driverClassName}&quot; /&gt;  
        &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot; /&gt;  
        &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot; /&gt;  
        &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;  
      &lt;/dataSource&gt;  
    &lt;/environment&gt;  
    &lt;environment id=&quot;production&quot;&gt;  
      &lt;transactionManager type=&quot;MANAGED&quot; /&gt;  
      &lt;dataSource type=&quot;JNDI&quot;&gt;  
        &lt;property name=&quot;data_source&quot; value=&quot;java:comp/jdbc/MyBatisDemoDS&quot; /&gt;  
      &lt;/dataSource&gt;  
    &lt;/environment&gt;  
  &lt;/environments&gt;  
  &lt;mappers&gt;  
    &lt;mapper resource=&quot;com/mybatis3/mappers/StudentMapper.xml&quot; /&gt;  
    &lt;mapper url=&quot;file:///D:/mybatisdemo/mappers/TutorMapper.xml&quot; /&gt;  
    &lt;mapper class=&quot;com.mybatis3.mappers.TutorMapper&quot; /&gt;  
  &lt;/mappers&gt;  
&lt;/configuration&gt;</code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/08/mybatis-2018-01-08-Mybatis-Configuration/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">08</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Mybatis/" itemprop="url" rel="index">
          <span itemprop="name">Mybatis</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/08/mybatis-2018-01-08-Mybatis-使用XML配置SQL映射器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/08/mybatis-2018-01-08-Mybatis-使用XML配置SQL映射器/" itemprop="url">Mybatis - 使用 XML 配置 SQL 映射器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T00:00:00+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="映射器配置文件和映射器接口"><a href="#映射器配置文件和映射器接口" class="headerlink" title="映射器配置文件和映射器接口"></a>映射器配置文件和映射器接口</h2><p>在 com.mybatis3.mappers 包中的 StudentMapper.xml 配置文件内，有个 id 为 ”findStudentById” 的 SQL 语句： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  </span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;  </span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;  </span><br><span class="line">&lt;mapper namespace=&quot;com.mybatis3.mappers.StudentMapper&quot;&gt;  </span><br><span class="line">  &lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot; resultType=&quot;Student&quot;&gt;  </span><br><span class="line">    select stud_id as studId, name, email, dob   </span><br><span class="line">    from Students where stud_id=#&#123;studId&#125;  </span><br><span class="line">  &lt;/select&gt;  </span><br><span class="line">&lt;/mapper&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以通过下列代码调用 findStudentById 映射的 SQL 语句: </span><br><span class="line">``` </span><br><span class="line">public Student findStudentById(long studId) &#123;  </span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSqlSession();  </span><br><span class="line">    try &#123;  </span><br><span class="line">        Student student =  </span><br><span class="line">            sqlSession.selectOne(&quot;com.mybatis3.mappers.StudentMapper.findStudentById&quot;, studId);  </span><br><span class="line">        return student;  </span><br><span class="line">    &#125; finally &#123;  </span><br><span class="line">        sqlSession.close();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以通过字符串（字符串形式为：映射器配置文件所在的包名 namespace + 在文件内定义的语句 id，如上，即包名 com.mybatis3.mappers.StudentMapper 和语句 id (findStudentById) 组成调用映射的 SQL 语句，但是这种方式容易出错。你需要检查映射器配置文件中的定义，以保证你的输入参数类型和结果返回类型是有效的。</span><br><span class="line">MyBatis 通过使用映射器 Mapper 接口提供了更好的调用映射语句的方法。**一旦我们通过映射器配置文件配置了映射语句，我们可以创建一个完全对应的一个映射器接口，接口名跟配置文件名相同，接口所在包名也跟配置文件所在包名完全一样(如 StudentMapper.xml 所在的包名是 com.mybatis3.mappers，对应的接口名就是 com.mybatis3.mappers.StudentMapper.java）**。映射器接口中的方法签名也跟映射器配置文件中完全对应：方法名为配置文件中 id 值；方法参数类型为 parameterType 对应值；方法返回值类型为 returnType 对应值。</span><br><span class="line"></span><br><span class="line">&lt;!--more--&gt; </span><br><span class="line"></span><br><span class="line">对于上述的 StudentMapper.xml 文件，我们可以创建一个映射器接口 StudentMapper.java 如下： </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    Student findStudentById(long id);  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">在 StudentMapper.xml 映射器配置文件中，其名空间 namespace 应该跟 StudentMapper 接口的完全限定名保持一致。另外，StudentMapper.xml 中语句 id, parameterType, returnType 应该分别和 StudentMapper 接口中的方法名，参数类型，返回值相对应。 </span><br><span class="line"></span><br><span class="line">使用映射器接口我们可以以类型安全的形式调用调用映射语句： </span><br><span class="line">``` </span><br><span class="line">public Student findStudentById(long studId) &#123;</span><br><span class="line">   SqlSession sqlSession = MyBatisUtil.getSqlSession();  </span><br><span class="line">   try &#123;  </span><br><span class="line">       StudentMapper studentMapper =  </span><br><span class="line">           sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">       return studentMapper.findStudentById(studId);  </span><br><span class="line">   &#125; finally &#123;  </span><br><span class="line">       sqlSession.close();  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;    </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">## 映射语句 </span><br><span class="line">MyBatis 提供了多种元素来配置不同类型的语句，如 SELECT，INSERT，UPDATE，DELETE。接下来让我们看看如何具体配置映射语句。 </span><br><span class="line"></span><br><span class="line">### INSERT 语句 </span><br><span class="line">一个 INSERT SQL 语句可以在 `&lt;insert&gt;` 元素在映射器 XML 配置文件中配置，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;  </span><br><span class="line">    INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL, PHONE)  </span><br><span class="line">        VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)  </span><br><span class="line">&lt;/insert&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里我们使用一个 ID insertStudent，可以在名空间 com.mybatis3.mappers.StudentMapper.insertStudent 中唯一标识。parameterType 属性应该是一个完全限定类名或者是一个类型别名（alias）。 </span><br><span class="line"></span><br><span class="line">我们可以如下调用这个语句： </span><br><span class="line">``` </span><br><span class="line">int count = sqlSession.insert(&quot;com.mybatis3.mappers.StudentMapper.insertStudent&quot;, student);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">sqlSession.insert() 方法返回执行 INSERT 语句后所影响的行数。</span><br><span class="line"></span><br><span class="line">如果不使用名空间（namespace）和语句id来调用映射语句，你可以通过创建一个映射器 Mapper 接口，并以类型安全的方式调用方法，如下所示: </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    int insertStudent(Student student);  </span><br><span class="line">&#125;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">然后可以如下调用 insertStudent 映射语句： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">int count = mapper.insertStudent(student);   </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 自动生成主键 </span><br><span class="line">在上述的 INSERT 语句中，我们为可以自动生成（auto-generated）主键的列 STUD_ID 插入值。我们可以使用 `useGeneratedKeys` 和 `keyProperty` 属性让数据库生成 auto_increment 列的值，并将生成的值设置到其中一个输入对象属性内，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot; useGeneratedKeys=&quot;true&quot;  </span><br><span class="line">         keyProperty=&quot;studId&quot;&gt;  </span><br><span class="line">    INSERT INTO STUDENTS(NAME, EMAIL, PHONE)   </span><br><span class="line">    VALUES(#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)  </span><br><span class="line">&lt;/insert&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里 STUD_ID 列值将会被 MySQL 数据库自动生成，并且生成的值会被设置到 student 对象的 studId 属性上。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">mapper.insertStudent(student); </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">现在可以如下获取插入的 STUDENT 记录的 STUD_ID 的值： </span><br><span class="line">``` </span><br><span class="line">long studentId = student.getStudId();  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">有些数据库如 Oracle 并不支持 AUTO_INCREMENT 列，其使用序列（SEQUENCE）来生成主键值。</span><br><span class="line"></span><br><span class="line">假设我们有一个名为 STUD_ID_SEQ 的序列来生成 STUD_ID 主键值。使用如下代码来生成主键： </span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;  </span><br><span class="line">    &lt;selectKey keyProperty=&quot;studId&quot; resultType=&quot;long&quot; order=&quot;BEFORE&quot;&gt;  </span><br><span class="line">        SELECT ELEARNING.STUD_ID_SEQ.NEXTVAL FROM DUAL  </span><br><span class="line">    &lt;/selectKey&gt;  </span><br><span class="line">    INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL, PHONE)  </span><br><span class="line">        VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)  </span><br><span class="line">&lt;/insert&gt;  </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">这里我们使用了 `selectKey` 子元素来生成主键值，并将值保存到 Student 对象的 studId 属性上。 属性 `order=&quot;before&quot;` 表示 MyBatis 将取得序列的下一个值作为主键值，并且在执行 INSERT SQL 语句之前将值设置到 studId 属性上。</span><br><span class="line"></span><br><span class="line">我们也可以在获取序列的下一个值时，使用触发器（trigger）来设置主键值，并且在执行 INSERT SQL 语句之前将值设置到主键列上。如果你采取这样的方式，则对应的 INSERT 映射语句如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;  </span><br><span class="line">    INSERT INTO STUDENTS(NAME,EMAIL, PHONE)  </span><br><span class="line">        VALUES(#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)  </span><br><span class="line">    &lt;selectKey keyProperty=&quot;studId&quot; resultType=&quot;long&quot; order=&quot;AFTER&quot;&gt;  </span><br><span class="line">        SELECT ELEARNING.STUD_ID_SEQ.CURRVAL FROM DUAL  </span><br><span class="line">    &lt;/selectKey&gt;  </span><br><span class="line">&lt;/insert&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### UPDATE 语句 </span><br><span class="line">一个 UPDATE SQL 语句可以在 `&lt;update&gt;` 元素在映射器 XML 配置文件中配置，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;update id=&quot;updateStudent&quot; parameterType=&quot;Student&quot;&gt;  </span><br><span class="line">    UPDATE STUDENTS SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, PHONE=#&#123;phone&#125;  </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/update&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以如下调用此语句： </span><br><span class="line">``` </span><br><span class="line">int noOfRowsUpdated = </span><br><span class="line">    sqlSession.update(&quot;com.mybatis3.mappers.StudentMapper.updateStudent&quot;, student);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">sqlSession.update() 方法返回执行 UPDATE 语句之后影响的行数。</span><br><span class="line"></span><br><span class="line">如果不使用名空间（namespace）和语句id来调用映射语句，你可以通过创建一个映射器 Mapper 接口，并以类型安全的方式调用方法，如下所示： </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    int updateStudent(Student student);  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">然后可以使用映射器Mapper接口来调用 updateStudent 语句： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">int noOfRowsUpdated = mapper.updateStudent(student); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### DELETE 语句 </span><br><span class="line">一个 UPDATE SQL 语句可以在 `&lt;update&gt;` 元素在映射器 XML 配置文件中配置，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;delete id=&quot;deleteStudent&quot; parameterType=&quot;long&quot;&gt;  </span><br><span class="line">   DELETE FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/delete&gt;   </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以如下调用此语句： </span><br><span class="line">``` </span><br><span class="line">long studId = 1;  </span><br><span class="line">int noOfRowsDeleted =  </span><br><span class="line">    sqlSession.delete(&quot;com.mybatis3.mappers.StudentMapper.deleteStudent&quot;, studId);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">sqlSession.delete() 方法返回 delete 语句执行后影响的行数。 </span><br><span class="line"></span><br><span class="line">如果不使用名空间（namespace）和语句 id 来调用映射语句，你可以通过创建一个映射器 Mapper 接口，并以类型安全的方式调用方法，如下所示：</span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    int deleteStudent(long studId);  </span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">然后以使用映射器Mapper接口来调用 updateStudent 语句： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">int noOfRowsDeleted = mapper.deleteStudent(studId);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### SELECT 语句  </span><br><span class="line">MyBatis 真正强大的功能，在于映射 SELECT 查询结果到 JavaBean 方面的极大灵活性。</span><br><span class="line"></span><br><span class="line">让我们看看一个简单的 select 查询是如何（在MyBatis中）配置的，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultType=&quot;Student&quot;&gt;  </span><br><span class="line">    SELECT STUD_ID, NAME, EMAIL, PHONE   </span><br><span class="line">        FROM STUDENTS   </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以如下调用此语句： </span><br><span class="line">``` </span><br><span class="line">long studId = 1;  </span><br><span class="line">Student student = </span><br><span class="line">    sqlSession.selectOne(&quot;com.mybatis3.mappers.StudentMapper.findStudentById&quot;, studId); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">如果不使用名空间（namespace）和语句id来调用映射语句，你可以通过创建一个映射器 Mapper 接口，并以类型安全的方式调用方法，如下所示：</span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    Student findStudentById(long studId);  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">然后可以使用映射器 Mapper 接口来调用 updateStudent 语句，如下所示： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">Student student = mapper.findStudentById(studId);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">如果你检查 Student 对象的属性值，你会发现 studId 属性值并没有被 stud_id 列值填充。这是因为 MyBatis 自动对 JavaBean 中和列名匹配的属性进行填充。这就是为什么 name，email，和 phone 属性被填充，而 studId 属性没有被填充。</span><br><span class="line"></span><br><span class="line">为了解决这一问题，我们可以为列名起一个可以与 JavaBean 中属性名匹配的别名，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultType=&quot;Student&quot;&gt;  </span><br><span class="line">    SELECT STUD_ID AS studId, NAME,EMAIL, PHONE   </span><br><span class="line">        FROM STUDENTS   </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">现在，Student 这个 Bean 对象中的值将会恰当地被 stud_id, name, email, phone 列填充了。</span><br><span class="line"></span><br><span class="line">现在，让我们看一下如何执行返回多条结果的 SELECT 语句查询，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;findAllStudents&quot; resultType=&quot;Student&quot;&gt;  </span><br><span class="line">    SELECT STUD_ID AS studId, NAME,EMAIL, PHONE   </span><br><span class="line">    FROM STUDENTS  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以如下调用此语句：  </span><br><span class="line">``` </span><br><span class="line">List&lt;Student&gt; students =   </span><br><span class="line">sqlSession.selectList(&quot;com.mybatis3.mappers.StudentMapper.findAllStudents&quot;); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">映射器 Mapper 接口 StudentMapper 可以如下定义： </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    List&lt;Student&gt; findAllStudents();  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">然后可以如下调用 findAllStudents 语句： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">List&lt;Student&gt; students = mapper.findAllStudents();</span><br></pre></td></tr></table></figure>

<p>如果你注意到上述的 SELECT 映射定义，你可以看到，我们为所有的映射语句中的 stud_id 起了别名。</p>
<p>我们可以使用 ResultMap，来避免上述的到处重复别名，我们稍后会继续讨论。</p>
<p>除了 <code>java.util.List</code>，你也可以是由其他类型的集合类，如 Set，Map，以及 SortedSet。MyBatis 根据集合的类型，会采用适当的集合实现，如下所示： </p>
<ul>
<li>对于 List，Collection，Iterable 类型，MyBatis 将返回 <code>java.util.ArrayList</code> </li>
<li>对于 Map 类型，MyBatis 将返回 <code>java.util.HashMap</code> </li>
<li>对于 Set 类型，MyBatis 将返回 <code>java.util.HashSet</code> </li>
<li>对于 SortedSet 类型，MyBatis 将返回 <code>java.util.TreeSet</code> </li>
</ul>
<h2 id="结果集映射-ResultMap"><a href="#结果集映射-ResultMap" class="headerlink" title="结果集映射 ResultMap"></a>结果集映射 ResultMap</h2><p>ResultMap 被用来将 SQL SELECT 语句的结果集映射到 JavaBean 的属性中。我们可以定义结果集映射 ResultMap 并且在一些 SELECT 语句上引用 resultMap。MyBatis 的结果集映射 ResultMap 特性非常强大，你可以使用它将简单的 SELECT 语句映射到复杂的一对一和一对多关系的 SELECT 语句上。</p>
<h3 id="简单-ResultMap"><a href="#简单-ResultMap" class="headerlink" title="简单 ResultMap"></a>简单 ResultMap</h3><p>一个映射了查询结果和 Student JavaBean 的简单的 resultMap 定义如下： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap id=&quot;StudentResult&quot; type=&quot;com.mybatis3.domain.Student&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;phone&quot; column=&quot;phone&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findAllStudents&quot; resultMap=&quot;StudentResult&quot;&gt;</span><br><span class="line">    SELECT * FROM STUDENTS  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot; resultMap=&quot;StudentResult&quot;&gt; </span><br><span class="line">    SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;   </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">resultMap 的 id 值 StudentResult 应该在此名空间内是唯一的。并且 type 属性应该是完全限定类名或者是返回类型的别名。</span><br><span class="line"></span><br><span class="line">`result` 子元素被用来将一个 resultset 列映射到 JavaBean 的一个属性中。</span><br><span class="line"></span><br><span class="line">`id` 元素和 `result` 元素功能相同，不过它被用来映射到唯一标识属性，用来区分和比较对象（一般和主键列相对应）。</span><br><span class="line"></span><br><span class="line">在 `&lt;select&gt;` 语句中，我们使用了 resultMap 属性，而不是 resultType 来引用 StudentResult 映射。当 `&lt;select&gt;` 语句中配置了 resultMap 属性，MyBatis 会使用此数据库列名与对象属性映射关系来填充 JavaBean 中的属性。 </span><br><span class="line"></span><br><span class="line">&gt; resultType 和 resultMap 二者只能用其一，不能同时使用。 </span><br><span class="line">&gt; </span><br><span class="line">&gt; resultType 指定一个实体类型，mybatis会自动将查询的结果填充到该实体对象中。 </span><br><span class="line">&gt; </span><br><span class="line">&gt; resultMap 可以自定义将查询的结果填充到对象的属性，对象的关联对象和关联集合上。</span><br><span class="line"></span><br><span class="line">让我们来看另外一个 `select` 映射语句定义的例子，怎样将查询结果填充到 HashMap 中。如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot; resultType=&quot;map&quot;&gt; </span><br><span class="line">    SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">在上述的 `&lt;select&gt;` 语句中，我们将 resultType 配置成 map，即 `java.util.HashMap` 的别名。在这种情况下，结果集的列名将会作为 Map 中的 key 值，而列值将作为 Map 的 value 值。 </span><br><span class="line">``` </span><br><span class="line">HashMap&lt;String,Object&gt; studentMap = </span><br><span class="line">    sqlSession.selectOne(&quot;com.mybatis3.mappers.StudentMapper.findStudentById&quot;, studId);  </span><br><span class="line">System.out.println(&quot;stud_id :&quot;+studentMap.get(&quot;stud_id&quot;));  </span><br><span class="line">System.out.println(&quot;name :&quot;+studentMap.get(&quot;name&quot;));  </span><br><span class="line">System.out.println(&quot;email :&quot;+studentMap.get(&quot;email&quot;));  </span><br><span class="line">System.out.println(&quot;phone :&quot;+studentMap.get(&quot;phone&quot;));  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">让我们再看一个 使用 `resultType=&quot;map&quot;` ，返回多行结果的例子： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;findAllStudents&quot; resultType=&quot;map&quot;&gt; </span><br><span class="line">    SELECT STUD_ID, NAME, EMAIL, PHONE FROM STUDENTS  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">由于 `resultType=”map&quot;` 和语句返回多行，则最终返回的数据类型应该是 `List&lt;HashMap&lt;String, Object&gt;&gt;` ，如下所示： </span><br><span class="line">``` </span><br><span class="line">List&lt;HashMap&lt;String, Object&gt;&gt; studentMapList =  </span><br><span class="line">    sqlSession.selectList(&quot;com.mybatis3.mappers.StudentMapper.findAllStudents&quot;);  </span><br><span class="line">for(HashMap&lt;String, Object&gt; studentMap : studentMapList) &#123;  </span><br><span class="line">    System.out.println(&quot;studId :&quot; + studentMap.get(&quot;stud_id&quot;));  </span><br><span class="line">    System.out.println(&quot;name :&quot; + studentMap.get(&quot;name&quot;));  </span><br><span class="line">    System.out.println(&quot;email :&quot; + studentMap.get(&quot;email&quot;));  </span><br><span class="line">    System.out.println(&quot;phone :&quot; + studentMap.get(&quot;phone&quot;));  </span><br><span class="line">&#125;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 拓展 ResultMap </span><br><span class="line">我们可以从另外一个 `resultMap` ，拓展出一个新的 `resultMap` ，这样，原先的属性映射可以继承过来。 </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;phone&quot; column=&quot;phone&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot; extends=&quot;StudentResult&quot;&gt;  </span><br><span class="line">  &lt;result property=&quot;address.addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>

<p>id 为 StudentWithAddressResult 的 resultMap 拓展了 id 为 StudentResult 的 resultMap。 </p>
<p>如果你只想映射 Student 数据，你可以使用 id 为 StudentResult 的 resultMap，如下所示： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;StudentResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">如果你想将映射 Student 数据和 Address 数据，你可以使用 id 为 StudentWithAddressResult 的 resultMap： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;selectStudentWithAddress&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">SELECT STUD_ID, NAME, EMAIL, PHONE, A.ADDR_ID, STREET, CITY,    </span><br><span class="line">        STATE, ZIP, COUNTRY  </span><br><span class="line">    FROM STUDENTS S LEFT OUTER JOIN ADDRESSES A ON   </span><br><span class="line">            S.ADDR_ID=A.ADDR_ID  </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">## 一对一映射 </span><br><span class="line">在我们的域模型样例中，每一个学生都有一个与之关联的地址信息。表 STUDENTS 有一个 ADDR_ID 列，是 ADDRESSES 表的外键。</span><br><span class="line"></span><br><span class="line">Student 和 Address 的 JavaBean 以及映射器 Mapper XML 文件定义如下所示：  </span><br><span class="line">``` </span><br><span class="line">public class Address &#123;  </span><br><span class="line">    private long addrId;  </span><br><span class="line">    private String street;  </span><br><span class="line">    private String city;  </span><br><span class="line">    private String state;  </span><br><span class="line">    private String zip;  </span><br><span class="line">    private String country;  </span><br><span class="line">    //setters &amp; getters  </span><br><span class="line">&#125;  </span><br><span class="line">public class Student &#123;  </span><br><span class="line">    private long studId;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private String email;  </span><br><span class="line">    private PhoneNumber phone;  </span><br><span class="line">    private Address address;  </span><br><span class="line">    //setters &amp; getters  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;phone&quot; column=&quot;phone&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;address.country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;selectStudentWithAddress&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">    SELECT STUD_ID, NAME, EMAIL, A.ADDR_ID, STREET, CITY, STATE,   </span><br><span class="line">        ZIP, COUNTRY  </span><br><span class="line">    FROM STUDENTS S LEFT OUTER JOIN ADDRESSES A ON   </span><br><span class="line">        S.ADDR_ID=A.ADDR_ID  </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">我们可以使用圆点记法为内嵌的对象的属性赋值。在上述的 resultMap 中，Student 的 address 属性使用了圆点记法被赋上了 address 对应列的值。同样地，我们可以访问任意深度的内嵌对象的属性。我们可以如下访问内嵌对象属性： </span><br><span class="line">``` </span><br><span class="line">//接口定义  </span><br><span class="line">public interface StudentMapper&#123;  </span><br><span class="line">    Student selectStudentWithAddress(long studId);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">//使用  </span><br><span class="line">long studId = 1;  </span><br><span class="line">StudentMapper studentMapper =  </span><br><span class="line">    sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">Student student = studentMapper.selectStudentWithAddress(studId);  </span><br><span class="line">System.out.println(&quot;Student :&quot; + student);  </span><br><span class="line">System.out.println(&quot;Address :&quot; + student.getAddress()); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">上述样例展示了一对一关联映射的一种方法。然而，使用这种方式映射，如果 address 结果需要在其他的 SELECT 映射语句中映射成 Address 对象，我们需要为每一个语句重复这种映射关系。MyBatis 提供了更好地实现一对一关联映射的方法：嵌套结果 ResultMap 和嵌套 select 查询语句。 </span><br><span class="line"></span><br><span class="line">### 使用嵌套结果 ResultMap 实现一对一关系映射 </span><br><span class="line">我们可以使用一个嵌套结果 ResultMap 方式来获取 Student 及其 Address 信息，代码如下： </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">&lt;resultMap type=&quot;Address&quot; id=&quot;AddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findStudentWithAddress&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">    SELECT STUD_ID, NAME, EMAIL, A.ADDR_ID, STREET, CITY, STATE,   </span><br><span class="line">    ZIP, COUNTRY  </span><br><span class="line">    FROM STUDENTS S LEFT OUTER JOIN ADDRESSES A ON   </span><br><span class="line">    S.ADDR_ID=A.ADDR_ID  </span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">元素 `&lt;association&gt;` 被用来导入“有一个”(has-one) 类型的关联。在上述的例子中，我们使用了 `&lt;association&gt;` 元素引用了另外的在同一个 XML 文件中定义的 `&lt;resultMap&gt;` 。</span><br><span class="line">我们也可以使用 `&lt;association` 定义内联的 `resultMap`，代码如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;association property=&quot;address&quot; javaType=&quot;Address&quot;&gt;  </span><br><span class="line">    &lt;id property=&quot;addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">  &lt;/association&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">使用嵌套结果 ResultMap 方式，关联的数据可以通过简单的查询语句（如果需要的话，需要与 joins 连接操作配合）进行加载。 </span><br><span class="line"></span><br><span class="line">### 使用嵌套查询实现一对一关系映射 </span><br><span class="line">我们可以通过使用嵌套 select 查询来获取 Student 及其 Address 信息，代码如下： </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Address&quot; id=&quot;AddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findAddressById&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;AddressResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM ADDRESSES WHERE ADDR_ID=#&#123;id&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">  &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;association property=&quot;address&quot; column=&quot;addr_id&quot; select=&quot;findAddressById&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findStudentWithAddress&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">在此方式中，`&lt;association&gt;` 元素的 select 属性被设置成了 id 为 findAddressById 的语句。这里，两个分开的 SQL 语句将会在数据库中执行，第一个调用 findStudentById 加载 student 信息，而第二个调用 findAddressById 来加载 address 信息。</span><br><span class="line"></span><br><span class="line">Addr_id 列的值将会被作为输入参数传递给 selectAddressById 语句。</span><br><span class="line"></span><br><span class="line">我们可以如下调用 findStudentWithAddress 映射语句： </span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">Student student = mapper.selectStudentWithAddress(studId);  </span><br><span class="line">System.out.println(student);  </span><br><span class="line">System.out.println(student.getAddress());   </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">## 一对多映射 </span><br><span class="line">在我们的域模型样例中，一个讲师可以教授一个或者多个课程。这意味着讲师和课程之间存在一对多的映射关系。</span><br><span class="line">我们可以使用 `&lt;collection&gt;` 元素将 一对多类型的结果映射到一个对象集合上。 </span><br><span class="line"></span><br><span class="line">Course和Tutor的JavaBean定义如下： </span><br><span class="line">``` </span><br><span class="line">public class Course &#123;  </span><br><span class="line">    private long courseId;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private String description;  </span><br><span class="line">    private Date startDate;  </span><br><span class="line">    private Date endDate;  </span><br><span class="line">    private long tutorId;  </span><br><span class="line">    //setters &amp; getters  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public class Tutor &#123;  </span><br><span class="line">    private long tutorId;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private String email;  </span><br><span class="line">    private Address address;  </span><br><span class="line">    private List&lt;Course&gt; courses;  </span><br><span class="line">    //setters &amp; getters  </span><br><span class="line">&#125;  </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">现在让我们看看如何获取讲师信息以及其所教授的课程列表信息。</span><br><span class="line"></span><br><span class="line">`&lt;collection&gt;` 元素被用来将多行课程结果映射成一个课程 Course 对象的一个集合。和一对一映射一样，我们可以使用嵌套结果 ResultMap 和嵌套 Select 语句两种方式映射实现一对多映射。 </span><br><span class="line"></span><br><span class="line">### 使用内嵌结果 ResultMap 实现一对多映射 </span><br><span class="line">我们可以使用嵌套结果 resultMap 方式获得讲师及其课程信息，代码如下： </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Course&quot; id=&quot;CourseResult&quot;&gt;  </span><br><span class="line">  &lt;id column=&quot;course_id&quot; property=&quot;courseId&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;name&quot; property=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;description&quot; property=&quot;description&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;start_date&quot; property=&quot;startDate&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;end_date&quot; property=&quot;endDate&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line"></span><br><span class="line">&lt;resultMap type=&quot;Tutor&quot; id=&quot;TutorResult&quot;&gt;  </span><br><span class="line">  &lt;id column=&quot;tutor_id&quot; property=&quot;tutorId&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;tutor_name&quot; property=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;email&quot; property=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;collection property=&quot;courses&quot; resultMap=&quot;CourseResult&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findTutorById&quot; parameterType=&quot;long&quot;   </span><br><span class="line">resultMap=&quot;TutorResult&quot;&gt;  </span><br><span class="line">SELECT T.TUTOR_ID, T.NAME AS TUTOR_NAME, EMAIL, C.COURSE_ID,   </span><br><span class="line">C.NAME, DESCRIPTION, START_DATE, END_DATE  </span><br><span class="line">FROM TUTORS T LEFT OUTER JOIN ADDRESSES A ON T.ADDR_ID=A.ADDR_ID  </span><br><span class="line">LEFT OUTER JOIN COURSES C ON T.TUTOR_ID=C.TUTOR_ID  </span><br><span class="line">WHERE T.TUTOR_ID=#&#123;tutorId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里我们使用了一个简单的使用了 JOINS 连接的 Select 语句获取讲师及其所教课程信息。`&lt;collection&gt;` 元素的 resultMap 属性设置成了 CourseResult，CourseResult 包含了 Course 对象属性与表列名之间的映射。 </span><br><span class="line"></span><br><span class="line">### 使用嵌套 Select 语句实现一对多映射 </span><br><span class="line">我们可以使用嵌套 Select 语句方式获得讲师及其课程信息，代码如下： </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Course&quot; id=&quot;CourseResult&quot;&gt;  </span><br><span class="line">  &lt;id column=&quot;course_id&quot; property=&quot;courseId&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;name&quot; property=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;description&quot; property=&quot;description&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;start_date&quot; property=&quot;startDate&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;end_date&quot; property=&quot;endDate&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;resultMap type=&quot;Tutor&quot; id=&quot;TutorResult&quot;&gt;  </span><br><span class="line">  &lt;id column=&quot;tutor_id&quot; property=&quot;tutorId&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;tutor_name&quot; property=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;email&quot; property=&quot;email&quot; /&gt;  </span><br><span class="line">  &lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt;  </span><br><span class="line">  &lt;collection property=&quot;courses&quot; column=&quot;tutor_id&quot; select=&quot;findCoursesByTutor&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;findTutorById&quot; parameterType=&quot;long&quot; resultMap=&quot;TutorResult&quot;&gt;  </span><br><span class="line">    SELECT T.TUTOR_ID, T.NAME AS TUTOR_NAME, EMAIL   </span><br><span class="line">    FROM TUTORS T WHERE T.TUTOR_ID=#&#123;tutorId&#125;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;findCoursesByTutor&quot; parameterType=&quot;long&quot; resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM COURSES WHERE TUTOR_ID=#&#123;tutorId&#125;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">在这种方式中，`&lt;aossication&gt;` 元素的 select 属性被设置为 id 为 findCourseByTutor 的语句，用来触发单独的 SQL 查询加载课程信息。tutor_id 这一列值将会作为输入参数传递给 findCouresByTutor 语句。   </span><br><span class="line">``` </span><br><span class="line">//接口定义</span><br><span class="line">public interface TutorMapper &#123;  </span><br><span class="line">    Tutor findTutorById(long tutorId);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">//使用</span><br><span class="line">TutorMapper mapper = sqlSession.getMapper(TutorMapper.class);  </span><br><span class="line">Tutor tutor = mapper.findTutorById(tutorId);  </span><br><span class="line">System.out.println(tutor);  </span><br><span class="line">List&lt;Course&gt; courses = tutor.getCourses();  </span><br><span class="line">for (Course course : courses) &#123;  </span><br><span class="line">    System.out.println(course);  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">&gt; 嵌套 Select 语句查询会导致 N + 1 问题。首先，主查询将会执行（1次），对于主查询返回的每一行，另外一个查询将会被执行（主查询 N 行，则此查询 N 次）。  </span><br><span class="line"></span><br><span class="line">## 动态 SQL </span><br><span class="line">有时候，静态的 SQL 语句并不能满足应用程序的需求。我们可以根据一些条件，来动态地构建 SQL 语句。  </span><br><span class="line"></span><br><span class="line">MyBatis 通过使用 `&lt;if&gt;` , `&lt;choose&gt;` , `&lt;where&gt;`, `&lt;foreach&gt;`, `&lt;trim&gt;` 元素提供了对构造动态 SQL 语句的高级别支持。 </span><br><span class="line"></span><br><span class="line">### If 条件 </span><br><span class="line">`&lt;if&gt;` 元素被用来有条件地嵌入 SQL 片段，如果测试条件被赋值为 true，则相应地 SQL 片段将会被添加到 SQL 语句中。</span><br><span class="line"></span><br><span class="line">假定我们有一个课程搜索界面，设置了 讲师（Tutor）下拉列表框，课程名称（CourseName）文本输入框，开始时间（StartDate）输入框，结束时间（EndDate）输入框，作为搜索条件。假定课讲师下拉列表是必须选的，其他的都是可选的。</span><br><span class="line"></span><br><span class="line">当用户点击 搜索按钮时，我们需要显示符合以下条件的成列表： </span><br><span class="line">- 特定讲师的课程</span><br><span class="line">- 课程名 包含输入的课程名称关键字的课程；如果课程名称输入为空，则取所有课程</span><br><span class="line">- 在开始时间和结束时间段内的课程 </span><br><span class="line"></span><br><span class="line">我们可以对应的映射语句，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;resultMap type=&quot;Course&quot; id=&quot;CourseResult&quot;&gt;  </span><br><span class="line">  &lt;id column=&quot;course_id&quot; property=&quot;courseId&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;name&quot; property=&quot;name&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;description&quot; property=&quot;description&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;start_date&quot; property=&quot;startDate&quot; /&gt;  </span><br><span class="line">  &lt;result column=&quot;end_date&quot; property=&quot;endDate&quot; /&gt;  </span><br><span class="line">&lt;/resultMap&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;select id=&quot;searchCourses&quot; parameterType=&quot;hashmap&quot; resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM COURSES  </span><br><span class="line">        WHERE TUTOR_ID= #&#123;tutorId&#125;  </span><br><span class="line">    &lt;if test=&quot;courseName != null&quot;&gt;  </span><br><span class="line">    AND NAME LIKE #&#123;courseName&#125;  </span><br><span class="line">    &lt;/if&gt;  </span><br><span class="line">    &lt;if test=&quot;startDate != null&quot;&gt;  </span><br><span class="line">    AND START_DATE &gt;= #&#123;startDate&#125;  </span><br><span class="line">    &lt;/if&gt;  </span><br><span class="line">    &lt;if test=&quot;endDate != null&quot;&gt;  </span><br><span class="line">    AND END_DATE &lt;= #&#123;endDate&#125;  </span><br><span class="line">    &lt;/if&gt;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">public interface CourseMapper &#123;  </span><br><span class="line">    List&lt;Course&gt; searchCourses(Map&lt;String, Object&gt; map);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public void searchCourses() &#123;  </span><br><span class="line">    Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();  </span><br><span class="line">    map.put(&quot;tutorId&quot;, 1);  </span><br><span class="line">    map.put(&quot;courseName&quot;, &quot;%java%&quot;);  </span><br><span class="line">    map.put(&quot;startDate&quot;, new Date());  </span><br><span class="line">    CourseMapper mapper = sqlSession.getMapper(CourseMapper.class);  </span><br><span class="line">    List&lt;Course&gt; courses = mapper.searchCourses(map);  </span><br><span class="line">    for (Course course : courses) &#123;  </span><br><span class="line">        System.out.println(course);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">此处将生成查询语句 `SELECT * FROM COURSES WHERE TUTOR_ID= ? AND NAME like? AND START_DATE &gt;= ?` 。 </span><br><span class="line"></span><br><span class="line">&gt; Mybatis 是使用 ONGL (Object Graph Navigation Language) 表达式来构建动态 SQL 语句。 </span><br><span class="line"></span><br><span class="line">### choose，when 和 otherwise 条件 </span><br><span class="line">有时候，查询功能是以查询类别为基础的。首先，用户需要选择是否希望通过选择讲师，课程名称，开始时间，或结束时间作为查询条件类别来进行查询，然后根据选择的查询类别，输入相应的参数。在这样的情景中，我们需要只使用其中一种查询类别。</span><br><span class="line"></span><br><span class="line">MyBatis 提供了 `&lt;choose&gt;` 元素支持此类型的 SQL 预处理。</span><br><span class="line"></span><br><span class="line">现在让我们书写一个适用此情景的 SQL 映射语句。如果没有选择查询类别，则查询开始时间在今天之后的课程，代码如下： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;searchCourses&quot; parameterType=&quot;hashmap&quot; resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM COURSES  </span><br><span class="line">    &lt;choose&gt;  </span><br><span class="line">        &lt;when test=&quot;searchBy == &apos;Tutor&apos;&quot;&gt;  </span><br><span class="line">            WHERE TUTOR_ID= #&#123;tutorId&#125;  </span><br><span class="line">        &lt;/when&gt;  </span><br><span class="line">        &lt;when test=&quot;searchBy == &apos;CourseName&apos;&quot;&gt;  </span><br><span class="line">            WHERE name like #&#123;courseName&#125;  </span><br><span class="line">        &lt;/when&gt;  </span><br><span class="line">        &lt;otherwise&gt;  </span><br><span class="line">            WHERE TUTOR start_date &gt;= now()  </span><br><span class="line">        &lt;/otherwise&gt;  </span><br><span class="line">    &lt;/choose&gt;  </span><br><span class="line">&lt;/select&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">MyBatis 计算 `&lt;choose&gt;` 测试条件的值，且使用第一个值为 TRUE 的子句。如果没有条件为 true，则使用 `&lt;otherwise&gt;` 内的子句。 </span><br><span class="line"></span><br><span class="line">### where 条件 </span><br><span class="line">有时候，所有的查询条件（criteria）应该是可选的。在需要使用至少一种查询条件的情况下，我们应该使用 WHERE子句。并且， 如果有多个条件，我们需要在条件中添加 AND 或 OR。MyBatis 提供了 `&lt;where&gt;` 元素支持这种类型的动态 SQL 语句。</span><br><span class="line"></span><br><span class="line">在我们查询课程界面，我们假设所有的查询条件是可选的。进而，当需要提供一个或多个查询条件时，应该改使用 WHERE 子句。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;searchCourses&quot; parameterType=&quot;hashmap&quot;   </span><br><span class="line">resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM COURSES  </span><br><span class="line">    &lt;where&gt;   </span><br><span class="line">        &lt;if test=&quot; tutorId != null &quot;&gt;  </span><br><span class="line">            TUTOR_ID= #&#123;tutorId&#125;  </span><br><span class="line">        &lt;/if&gt;  </span><br><span class="line">        &lt;if test=&quot;courseName != null&quot;&gt;  </span><br><span class="line">            AND name like #&#123;courseName&#125;  </span><br><span class="line">        &lt;/if&gt;  </span><br><span class="line">        &lt;if test=&quot;startDate != null&quot;&gt;  </span><br><span class="line">            AND start_date &gt;= #&#123;startDate&#125;  </span><br><span class="line">        &lt;/if&gt;  </span><br><span class="line">        &lt;if test=&quot;endDate != null&quot;&gt;  </span><br><span class="line">            AND end_date &lt;= #&#123;endDate&#125;  </span><br><span class="line">        &lt;/if&gt;  </span><br><span class="line">    &lt;/where&gt;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">`&lt;where&gt;` 元素只有在其内部标签有返回内容时才会在动态语句上插入 WHERE 条件语句。并且，如果 WHERE 子句以 AND 或者 OR 打头，则打头的 AND 或 OR 将会被移除。</span><br><span class="line"></span><br><span class="line">如果 tutor_id 参数值为 null，并且 courseName 参数值不为 null，则 `&lt;where&gt;` 标签会将 AND name like#&#123;courseName&#125; 中的 AND 移除掉，生成的 SQL WHERE 子句为：where name like#&#123;courseName&#125;。 </span><br><span class="line"></span><br><span class="line">### trim 条件 </span><br><span class="line">`&lt;trim&gt;` 元素和 `&lt;where&gt;` 元素类似，但是 `&lt;trim&gt;` 提供了在添加前缀/后缀 或者移除前缀/后缀方面提供更大的灵活性。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;searchCourses&quot; parameterType=&quot;hashmap&quot;   </span><br><span class="line">resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">SELECT * FROM COURSES  </span><br><span class="line">&lt;trim prefix=&quot;WHERE&quot; prefixOverrides=&quot;AND | OR&quot;&gt;  </span><br><span class="line">&lt;if test=&quot; tutorId != null &quot;&gt;  </span><br><span class="line">TUTOR_ID= #&#123;tutorId&#125;  </span><br><span class="line">&lt;/if&gt;  </span><br><span class="line">&lt;if test=&quot;courseName != null&quot;&gt;  </span><br><span class="line">AND name like #&#123;courseName&#125;  </span><br><span class="line">&lt;/if&gt;  </span><br><span class="line">&lt;/trim&gt;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里如果任意一个 `&lt;if&gt;` 条件为 true， `&lt;trim&gt;` 元素会插入 WHERE,并且移除紧跟 WHERE 后面的 AND 或 OR。 </span><br><span class="line"></span><br><span class="line">### foreach 循环 </span><br><span class="line">另外一个强大的动态 SQL 语句构造标签即是 `&lt;foreach&gt;` 。它可以迭代遍历一个数组或者列表，构造 AND/OR 条件或一个 IN 子句。</span><br><span class="line"></span><br><span class="line">假设我们想找到 tutor_id 为1，3，6的讲师所教授的课程，我们可以传递一个 tutor_id 组成的列表给映射语句，然后通过 `&lt;foreach&gt;` 遍历此列表构造动态 SQL。 </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;searchCoursesByTutors&quot; parameterType=&quot;map&quot;   </span><br><span class="line">resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">SELECT * FROM COURSES  </span><br><span class="line">&lt;if test=&quot;tutorIds != null&quot;&gt;  </span><br><span class="line">&lt;where&gt;  </span><br><span class="line">&lt;foreach item=&quot;tutorId&quot; collection=&quot;tutorIds&quot;&gt;  </span><br><span class="line">OR tutor_id=#&#123;tutorId&#125;  </span><br><span class="line">&lt;/foreach&gt;  </span><br><span class="line">&lt;/where&gt;   </span><br><span class="line">&lt;/if&gt;   </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">public interface CourseMapper &#123;  </span><br><span class="line">    List&lt;Course&gt; searchCoursesByTutors(Map&lt;String, Object&gt; map);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public void searchCoursesByTutors() &#123;  </span><br><span class="line">    Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();  </span><br><span class="line">    List&lt;Long&gt; tutorIds = new ArrayList&lt;Long&gt;();  </span><br><span class="line">    tutorIds.add(1);  </span><br><span class="line">    tutorIds.add(3);  </span><br><span class="line">    tutorIds.add(6);  </span><br><span class="line">    map.put(&quot;tutorIds&quot;, tutorIds);  </span><br><span class="line">    CourseMapper mapper =  </span><br><span class="line">        sqlSession.getMapper(CourseMapper.class);  </span><br><span class="line">    List&lt;Course&gt; courses = mapper.searchCoursesByTutors(map);  </span><br><span class="line">    for (Course course : courses) &#123;  </span><br><span class="line">        System.out.println(course);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">现在让我们来看一下怎样使用 `&lt;foreach&gt;` 生成 IN 子句： </span><br><span class="line">``` </span><br><span class="line">&lt;select id=&quot;searchCoursesByTutors&quot; parameterType=&quot;map&quot;   </span><br><span class="line">resultMap=&quot;CourseResult&quot;&gt;  </span><br><span class="line">    SELECT * FROM COURSES  </span><br><span class="line">    &lt;if test=&quot;tutorIds != null&quot;&gt;  </span><br><span class="line">        &lt;where&gt;  </span><br><span class="line">        tutor_id IN  </span><br><span class="line">            &lt;foreach item=&quot;tutorId&quot; collection=&quot;tutorIds&quot;   </span><br><span class="line">            open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;  </span><br><span class="line">            #&#123;tutorId&#125;  </span><br><span class="line">            &lt;/foreach&gt;  </span><br><span class="line">        &lt;/where&gt;  </span><br><span class="line">    &lt;/if&gt;  </span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<h3 id="set-条件"><a href="#set-条件" class="headerlink" title="set 条件"></a>set 条件</h3><p><code>&lt;set&gt;</code> 元素和 <code>&lt;where&gt;</code> 元素类似，如果其内部条件判断有任何内容返回时，他会插入 SET SQL 片段。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;updateStudent&quot; parameterType=&quot;Student&quot;&gt;  </span><br><span class="line">    update students   </span><br><span class="line">    &lt;set&gt;  </span><br><span class="line">    &lt;if test=&quot;name != null&quot;&gt;name=#&#123;name&#125;,&lt;/if&gt;  </span><br><span class="line">    &lt;if test=&quot;email != null&quot;&gt;email=#&#123;email&#125;,&lt;/if&gt;  </span><br><span class="line">    &lt;if test=&quot;phone != null&quot;&gt;phone=#&#123;phone&#125;,&lt;/if&gt;  </span><br><span class="line">    &lt;/set&gt;  </span><br><span class="line">    where stud_id=#&#123;id&#125;  </span><br><span class="line">&lt;/update&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里，如果 `&lt;if&gt;` 条件返回了任何文本内容，`&lt;set&gt;` 将会插入 set 关键字和其文本内容，并且会剔除将末尾的 “,”。 </span><br><span class="line">在上述的例子中，如果 phone!=null, `&lt;set&gt;` 将会让会移除  phone=#&#123;phone&#125; 后的逗号“,”，生成 set phone=#&#123;phone&#125;。 </span><br><span class="line"></span><br><span class="line">## Mybatis 补充说明 </span><br><span class="line">除了简化数据库编程外，MyBatis 还提供了各种功能，这些对实现一些常用任务非常有用，比如按页加载表数据，存取 CLOB/BLOB 类型的数据，处理枚举类型值，等等。 </span><br><span class="line"></span><br><span class="line">### 处理枚举类型 </span><br><span class="line">MyBatis 支持开箱方式持久化 enum 类型属性。假设 STUDENTS 表中有一列 gender（性别）类型为 varchar，存储 ”MALE” 或者 “FEMALE” 两种值。并且，Student 对象有一个 enum 类型的 gender 属性，如下所示： </span><br><span class="line">``` </span><br><span class="line">public enum Gender &#123;  </span><br><span class="line">    FEMALE,  </span><br><span class="line">    MALE  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">默认情况下，MyBatis 使用 EnumTypeHandler 来处理 enum 类型的 Java 属性，并且将其存储为 enum 值的名称。你不需要为此做任何额外的配置。你可以可以向使用基本数据类型属性一样使用 enum 类型属性，代码如下： </span><br><span class="line">``` </span><br><span class="line">public class Student &#123;  </span><br><span class="line">    private Integer id;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private String email;  </span><br><span class="line">    private PhoneNumber phone;  </span><br><span class="line">    private Address address;  </span><br><span class="line">    private Gender gender;  </span><br><span class="line">    //setters and getters  </span><br><span class="line">&#125; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;   </span><br><span class="line">useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;  </span><br><span class="line">insert into students(name,email,addr_id, phone,gender)  </span><br><span class="line">values(#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;,#&#123;gender&#125;)  </span><br><span class="line">&lt;/insert&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">当你执行 insertStudent 语句的时候，MyBatis 会取 Gender 枚举（FEMALE/MALE）的名称，然后将其存储到 GENDER 列中。</span><br><span class="line">如果你希望存储原enum的顺序位置，而不是enum名，你需要明确地配置它。</span><br><span class="line"></span><br><span class="line">如果你想存储 FEMALE 为 0，MALE 为 1 到 gender 列中，你需要在 `mybatis-config.xml` 文件中配置 EnumOrdinalTypeHandler: </span><br><span class="line">``` </span><br><span class="line">&lt;typeHandler   </span><br><span class="line">handler=&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot;  </span><br><span class="line">javaType=&quot;com.mybatis3.domain.Gender&quot;/&gt;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">&gt; 使用顺序位置为值存储到数据库时要当心。顺序值是根据 enum 中的生命顺序赋值的。如果你改变了 Gender enum 的声明顺序，则数据库存储的数据和顺序值就不匹配了。  </span><br><span class="line"></span><br><span class="line">### 处理 CLOB/BLOB 类型数据 </span><br><span class="line">MyBatis 提供了内建的对 CLOB/BLOB 类型列的映射处理支持。</span><br><span class="line"></span><br><span class="line">假设我们有如下的表结构来存储学生和讲师的照片和简介信息： </span><br><span class="line">```  </span><br><span class="line">CREATE TABLE USER_PICS   </span><br><span class="line">(  </span><br><span class="line">ID INT(11) NOT NULL AUTO_INCREMENT,  </span><br><span class="line">NAME VARCHAR(50) DEFAULT NULL,  </span><br><span class="line">PIC BLOB,  </span><br><span class="line">BIO LONGTEXT,  </span><br><span class="line">PRIMARY KEY (ID)  </span><br><span class="line">) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=LATIN1;   </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里，照片可以是PNG,JPG或其他格式的。简介信息可以是学生或者讲师的漫长的人生经历。默认情况下，MyBatis 将 CLOB 类型的列映射到 `java.lang.String` 类型上、而把 BLOB 列映射到 byte[] 类型上。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">public class UserPic &#123;  </span><br><span class="line">    private long id;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private byte[] pic;  </span><br><span class="line">    private String bio;  </span><br><span class="line">    //setters &amp; getters  </span><br><span class="line">&#125;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">创建 UserPicMapper.xml 文件，配置映射语句，代码如下： </span><br><span class="line">``` </span><br><span class="line">&lt;insert id=&quot;insertUserPic&quot; parameterType=&quot;UserPic&quot;&gt;  </span><br><span class="line">    INSERT INTO USER_PICS(NAME, PIC,BIO)  </span><br><span class="line">    VALUES(#&#123;name&#125;,#&#123;pic&#125;,#&#123;bio&#125;)  </span><br><span class="line">&lt;/insert&gt;  </span><br><span class="line">&lt;select id=&quot;getUserPic&quot; parameterType=&quot;long&quot; resultType=&quot;UserPic&quot;&gt;  </span><br><span class="line">    SELECT * FROM USER_PICS WHERE ID=#&#123;id&#125;  </span><br><span class="line">&lt;/select&gt; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">下列的 insertUserPic() 展示了如何将数据插入到 CLOB/BLOB 类型的列上：</span><br><span class="line">``` </span><br><span class="line">public void insertUserPic() &#123;  </span><br><span class="line">    byte[] pic = null;  </span><br><span class="line">    try &#123;  </span><br><span class="line">        File file = new File(&quot;C:\\Images\\UserImg.jpg&quot;);  </span><br><span class="line">        InputStream is = new FileInputStream(file);  </span><br><span class="line">        pic = new byte[is.available()];  </span><br><span class="line">        is.read(pic);  </span><br><span class="line">        is.close();  </span><br><span class="line">    &#125; catch (FileNotFoundException e) &#123;  </span><br><span class="line">        e.printStackTrace();  </span><br><span class="line">    &#125; catch (IOException e) &#123;  </span><br><span class="line">        e.printStackTrace();  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    String name = &quot;UserName&quot;;  </span><br><span class="line">    String bio = &quot;put some lenghty bio here&quot;;  </span><br><span class="line">    UserPic userPic = new UserPic(0, name, pic , bio);  </span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.openSession();  </span><br><span class="line">    </span><br><span class="line">    try &#123;  </span><br><span class="line">        UserPicMapper mapper =  </span><br><span class="line">            sqlSession.getMapper(UserPicMapper.class);  </span><br><span class="line">        mapper.insertUserPic(userPic);  </span><br><span class="line">        sqlSession.commit();  </span><br><span class="line">    &#125; finally &#123;  </span><br><span class="line">        sqlSession.close();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">下面的 getUserPic() 方法展示了怎样将 CLOB 类型数据读取到 String 类型，BLOB 类型数据读取成 byte[] 属性： </span><br><span class="line">``` </span><br><span class="line">public void getUserPic() &#123;  </span><br><span class="line">    UserPic userPic = null;  </span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.openSession();  </span><br><span class="line">    try &#123;  </span><br><span class="line">        UserPicMapper mapper =  </span><br><span class="line">            sqlSession.getMapper(UserPicMapper.class);  </span><br><span class="line">        userPic = mapper.getUserPic(1);  </span><br><span class="line">    &#125; finally &#123;  </span><br><span class="line">        sqlSession.close();  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    byte[] pic = userPic.getPic();  </span><br><span class="line">    try &#123;  </span><br><span class="line">        OutputStream os = </span><br><span class="line">            new FileOutputStream(new File(&quot;C:\\Images\\UserImage_FromDB.jpg&quot;));  </span><br><span class="line">        os.write(pic);  </span><br><span class="line">        os.close();  </span><br><span class="line">    &#125; catch (FileNotFoundException e) &#123;  </span><br><span class="line">        e.printStackTrace();  </span><br><span class="line">    &#125; catch (IOException e) &#123;  </span><br><span class="line">        e.printStackTrace();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 传入多个输入参数 </span><br><span class="line">MyBatis 中的映射语句有一个 parameterType 属性来制定输入参数的类型。如果我们想给映射语句传入多个参数的话，我们可以将所有的输入参数放到 HashMap 中，将 HashMap 传递给映射语句。</span><br><span class="line"></span><br><span class="line">MyBatis 还提供了另外一种传递多个输入参数给映射语句的方法。假设我们想通过给定的 name 和 email 信息查找学生信息，定义查询接口如下： </span><br><span class="line">``` </span><br><span class="line">Public interface StudentMapper &#123;  </span><br><span class="line">    List&lt;Student&gt; findAllStudentsByNameEmail(String name, String email);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyBatis 支持将多个输入参数传递给映射语句，并以 <code>#{param}</code> 的语法形式引用它们： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findAllStudentsByNameEmail&quot; resultMap=&quot;StudentResult&quot;&gt;  </span><br><span class="line">    select stud_id, name,email, phone from Students  </span><br><span class="line">        where name=#&#123;param1&#125; and email=#&#123;param2&#125;  </span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>这里 <code>#{param1}</code> 引用第一个参数 name，而 <code>#{param2}</code> 引用了第二个参数 email。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">studentMapper.findAllStudentsByNameEmail(name, email);</span><br></pre></td></tr></table></figure>

<h3 id="多行结果集映射成-Map"><a href="#多行结果集映射成-Map" class="headerlink" title="多行结果集映射成 Map"></a>多行结果集映射成 Map</h3><p>如果你有一个映射语句返回多行记录，并且你想以 HashMap 的形式存储记录的值，使用记录列名作为 key 值，而记录对应值或为 value 值。我们可以使用 sqlSession.selectMap(),如下所示： </p>
<pre><code>&lt;select id=&quot; findAllStudents&quot; resultMap=&quot;StudentResult&quot;&gt;  
    select * from Students  
&lt;/select&gt;  </code></pre><p>查询： </p>
<pre><code>Map&lt;Long, Student&gt; studentMap =   
sqlSession.selectMap(&quot;com.mybatis3.mappers.StudentMapper.findAllStudents&quot;, &quot;studId&quot;);   </code></pre><p>这里 studentMap 将会将 studId 作为 key 值，而 Student 对象作为 value 值。 </p>
<h3 id="使用-RowBounds-对结果集进行分页"><a href="#使用-RowBounds-对结果集进行分页" class="headerlink" title="使用 RowBounds 对结果集进行分页"></a>使用 RowBounds 对结果集进行分页</h3><p>有时候，我们会需要跟海量的数据打交道，比如一个有数百万条数据级别的表。由于计算机内存的现实我们不可能一次性加载这么多数据，我们可以获取到数据的一部分。特别是在 Web 应用程序中，分页机制被用来以一页一页的形式展示海量的数据。</p>
<p>MyBatis 可以使用 RowBounds 逐页加载表数据。RowBounds 对象可以使用 offset 和 limit 参数来构建。参数 offset 表示开始位置，而 limit 表示要取的记录的数目。</p>
<p>假设如果你想每页加载并显示 25 条学生的记录，你可以使用如下的代码： </p>
<pre><code>&lt;select id=&quot;findAllStudents&quot; resultMap=&quot;StudentResult&quot;&gt;  
    select * from Students  
&lt;/select&gt; </code></pre><p>然后，你可以如下加载第一页数据（前25条）： </p>
<pre><code>int offset = 0 , limit = 25;  
RowBounds rowBounds = new RowBounds(offset, limit);  
List&lt;Student&gt; = studentMapper.getStudents(rowBounds);  </code></pre><p>若要展示第二页，使用 offset = 25,limit = 25; 第三页，则为 offset = 50，limit = 25。 </p>
<h3 id="使用-ResultSetHandler-自定义处理结果集-resultSet"><a href="#使用-ResultSetHandler-自定义处理结果集-resultSet" class="headerlink" title="使用 ResultSetHandler 自定义处理结果集 resultSet"></a>使用 ResultSetHandler 自定义处理结果集 resultSet</h3><p>MyBatis 在将查询结果集映射到 JavaBean 方面提供了很大的选择性。但是，有时候我们会遇到由于特定的目的，需要我们自己处理 SQL 查询结果的情况。MyBatis 提供了 ResultHandler 插件形式允许我们以任何自己喜欢的方式处理结果集 ResultSet。</p>
<p>假设我们想从学生的 stud_id 被用作 key，而 name 被用作 value 的 HashMap 中获取到 student 信息。 </p>
<blockquote>
<p><code>mybatis-3.2.2</code> 并不支持使用 resultMap 配置将查询的结果集映射成一个属性为 key，而另外属性为 value 的 HashMap。<br>sqlSession.selectMap() 则可以返回以给定列为 key，记录对象为 value 的 map。<br>我们不能将其配置成其中一个属性作为 key，而另外的属性作为 value。 </p>
</blockquote>
<p>对于 sqlSession.select() 方法，我们可以传递给它一个 ResultHandler 的实现，它会被调用来处理 ResultSet 的每一条记录。 </p>
<pre><code>public interface ResultHandler {   
    void handleResult(ResultContext context);  
} </code></pre><p>现在我们来看一下怎么使用 ResultHandler 来处理结果集 ResultSet，并返回自定义化的结果。 </p>
<pre><code>public Map&lt;Long, String&gt; getStudentIdNameMap() {  

    final Map&lt;Long, String&gt; map = new HashMap&lt;Long, String&gt;();  
    SqlSession sqlSession = MyBatisUtil.openSession();  

    try {  
        sqlSession.select(&quot;com.mybatis3.mappers.StudentMapper.findAllStudents&quot;
            , new ResultHandler() {  
                @Override  
                public void handleResult(ResultContext context) {  
                    Student student = (Student) context.getResultObject();  
                    map.put(student.getStudId(), student.getName());  
                }  
            }  
    } finally {  
        sqlSession.close();  
    }  

    return map;  
}  </code></pre><p>在上述的代码中，我们提供了匿名内部 ResultHandler 实现类，在 handleResult() 方法中，我们使用 context.getResultObject() 获取当前的 result 对象，即 Student 对象，因为我们定义了 findAllStudent 映射语句的 <code>resultMap=&quot;studentResult&quot;</code> 。对查询返回的每一行都会调用 handleResult() 方法，并且我们从 Student 对象中取出 studId 和 name，将其放到 map 中。 </p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>将从数据库中加载的数据缓存到内存中，是很多应用程序为了提高性能而采取的一贯做法。MyBatis 对通过映射的 SELECT 语句加载的查询结果提供了内建的缓存支持。默认情况下，启用一级缓存，即，如果你使用同一个 SqlSession 接口对象调用了相同的 SELECT 语句，则直接会从缓存中返回结果，而不是再查询一次数据库。</p>
<p>我们可以在 SQL 映射器 XML 配置文件中使用 <code>&lt;cache /&gt;</code> 元素添加全局二级缓存。</p>
<p>当你加入了 <code>&lt;cache /&gt;</code> 元素，将会出现以下情况： </p>
<ul>
<li>所有的在映射语句文件定义的 <code>select</code> 语句的查询结果都会被缓存</li>
<li>所有的在映射语句文件定义的 <code>insert</code>，<code>update</code> 和 <code>delete</code> 语句将会刷新缓存</li>
<li>缓存根据最近最少被使用（Least Recently Used，LRU）算法管理</li>
<li>缓存不会被任何形式的基于时间表的刷新（没有刷新时间间隔），即不支持定时刷新机制</li>
<li>缓存将存储 1024 个查询方法返回的列表或者对象的引用</li>
<li>缓存会被当作一个读/写缓存。这是指检索出的对象不会被共享，并且可以被调用者安全地修改，不会有其他潜在的调用者或者线程的潜在修改干扰，即，缓存是线程安全的。 </li>
</ul>
<p>你也可以通过复写默认属性来自定义缓存的行为，如下所示： </p>
<pre><code>&lt;cache eviction=&quot;FIFO&quot; flushInterval=&quot;60000&quot; size=&quot;512&quot;   
readOnly=&quot;true&quot;/&gt;  </code></pre><p>以下是对上述属性的描述： </p>
<ul>
<li>eviction:此处定义缓存的移除机制。默认值是 LRU，其可能的值有：LRU（least recently used,最近最少使用），FIFO(first in first out,先进先出)，SOFT(soft reference,软引用)，WEAK（weak reference,弱引用）。</li>
<li>flushInterval:定义缓存刷新间隔，以毫秒计。默认情况下不设置。所以不使用刷新间隔时，缓存cache只有在调用语句的时候刷新。</li>
<li>size:表示缓存cache中能容纳的最大元素数。默认值是1024，你也可以设置成任意的正整数。</li>
<li>readOnly:一个只读的缓存 cache 会对所有的调用者返回被缓存对象的同一个实例（实际返回的是被返回对象的一份引用）。一个读/写缓存 cache 将会返回被返回对象的一分拷贝（通过序列化）。默认情况下设置为 false。可能的值有 false 和 true。</li>
</ul>
<p>一个缓存的配置和缓存实例被绑定到映射器配置文件所在的名空间（namespace）上，所以在相同名空间内的所有语句被绑定到一个 cache 中。</p>
<p>默认的映射语句的 cache 配置如下： </p>
<pre><code>&lt;select... flushCache=&quot;false&quot; useCache=&quot;true&quot;/&gt;  
&lt;insert ... flushCache=&quot;true&quot;/&gt;  
&lt;update ... flushCache=&quot;true&quot;/&gt;  
&lt;delete ... flushCache=&quot;true&quot;/&gt; </code></pre><p>你可以为任意特定的映射语句复写默认的 cache 行为；例如，对一个 select 语句不使用缓存，可以设置 useCache=”false”。</p>
<p>除了内建的缓存支持，MyBatis 也提供了与第三方缓存类库如 <code>Ehcache</code> ， <code>OSCache</code> ， <code>Hazelcast</code> 的集成支持。你可以在 <a href="https://code.google.com/p/mybatis/wiki/Caches" target="_blank" rel="noopener">MyBatis官方网站</a> 上找到关于继承第三方缓存类库的更多信息。  </p>
<blockquote>
<p><a href="http://blog.csdn.net/luanlouis/article/details/35594455" target="_blank" rel="noopener">Java Persistence with MyBatis 3(中文版) 第三章 使用XML配置SQL映射器</a></p>
</blockquote>

            <div class="post-button text-center">
              <a class="btn" href="/2018/01/08/mybatis-2018-01-08-Mybatis-使用XML配置SQL映射器/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">08</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Mybatis/" itemprop="url" rel="index">
          <span itemprop="name">Mybatis</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/08/mybatis-2018-01-08-Mybatis-使用注解配置SQL映射器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/08/mybatis-2018-01-08-Mybatis-使用注解配置SQL映射器/" itemprop="url">Mybatis - 使用注解配置 SQL 映射器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T00:00:00+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在映射器-Mapper-接口上使用-Mapper-注解"><a href="#在映射器-Mapper-接口上使用-Mapper-注解" class="headerlink" title="在映射器 Mapper 接口上使用 @Mapper 注解"></a>在映射器 Mapper 接口上使用 @Mapper 注解</h2><h2 id="映射语句"><a href="#映射语句" class="headerlink" title="映射语句"></a>映射语句</h2><p>MyBatis 提供了多种注解来支持不同类型的语句(statement)如 SELECT，INSERT，UPDATE，DELETE。</p>
<h3 id="Insert"><a href="#Insert" class="headerlink" title="@Insert"></a>@Insert</h3><p>我们可以使用 <code>@Insert</code> 注解来定义一个 INSERT 映射语句： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    @Insert(&quot;INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,ADDR_ID, PHONE)  </span><br><span class="line">            VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)  </span><br><span class="line">    int insertStudent(Student student);  </span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">使用了 `@Insert` 注解的 insertMethod() 方法将返回 insert 语句执行后影响的行数。 </span><br><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"></span><br><span class="line">#### 自动生成主键 </span><br><span class="line">我们可以使用 `@Options` 注解的 `userGeneratedKeys` 和 `keyProperty` 属性让数据库产生 auto_increment（自增长）列的值，然后将生成的值设置到输入参数对象的属性中。 </span><br><span class="line">``` </span><br><span class="line">@Insert(&quot;INSERT INTO STUDENTS(NAME,EMAIL,ADDR_ID, PHONE)  </span><br><span class="line">        VALUES(#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)  </span><br><span class="line">@Options(useGeneratedKeys = true, keyProperty = &quot;studId&quot;)  </span><br><span class="line">int insertStudent(Student student);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里 STUD_ID 列值将会通过MySQL数据库自动生成。并且生成的值将会被设置到 student 对象的 studId 属性中。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">mapper.insertStudent(student);  </span><br><span class="line">long studentId = student.getStudId(); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">有一些数据库如 Oracle，并不支持 AUTO_INCREMENT 列属性，它使用序列（SEQUENCE）来产生主键的值。</span><br><span class="line">我们可以使用 `@SelectKey` 注解来为任意 SQL 语句来指定主键值，作为主键列的值。</span><br><span class="line"></span><br><span class="line">假设我们有一个名为 `STUD_ID_SEQ` 的序列来生成 `STUD_ID` 主键值。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">@Insert(&quot;INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,ADDR_ID, PHONE)   </span><br><span class="line">VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)  </span><br><span class="line">@SelectKey(statement=&quot;SELECT STUD_ID_SEQ.NEXTVAL FROM DUAL&quot;,   </span><br><span class="line">keyProperty=&quot;studId&quot;, resultType=long.class, before=true)  </span><br><span class="line">int insertStudent(Student student); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">这里我们使用了 `@SelectKey` 来生成主键值，并且存储到了 student 对象的 studId 属性上。由于我们设置了 `before=true`，该语句将会在执行 INSERT 语句之前执行。</span><br><span class="line"></span><br><span class="line">如果你使用序列作为触发器来设置主键值，我们可以在 INSERT 语句执行后，从 `sequence_name.currval` 获取数据库产生的主键值。 </span><br><span class="line">``` </span><br><span class="line">@Insert(&quot;INSERT INTO STUDENTS(NAME,EMAIL,ADDR_ID, PHONE)   </span><br><span class="line">VALUES(#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)  </span><br><span class="line">@SelectKey(statement=&quot;SELECT STUD_ID_SEQ.CURRVAL FROM DUAL&quot;,   </span><br><span class="line">keyProperty=&quot;studId&quot;, resultType=long.class, before=false)  </span><br><span class="line">int insertStudent(Student student);  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### @Update </span><br><span class="line">我们可以使用 `@Update` 注解来定义一个UPDATE映射语句，如下所示： </span><br><span class="line">``` </span><br><span class="line">@Update(&quot;UPDATE STUDENTS SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;,   </span><br><span class="line">PHONE=#&#123;phone&#125; WHERE STUD_ID=#&#123;studId&#125;&quot;)  </span><br><span class="line">int updateStudent(Student student); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">使用了 `@Update` 的 `updateStudent()` 方法将会返回执行了 update 语句后影响的行数。 </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">int noOfRowsUpdated = mapper.updateStudent(student); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### @Delete </span><br><span class="line">我们可以使用 `@Delete` 注解来定义一个 DELETE 映射语句，如下所示： </span><br><span class="line">``` </span><br><span class="line">@Delete(&quot;DELETE FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;&quot;)  </span><br><span class="line">int deleteStudent(long studId); </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">使用了 `@Delete` 的 `deleteStudent()` 方法将会返回执行了 delete 语句后影响的行数。</span><br><span class="line"></span><br><span class="line">### @Select </span><br><span class="line">我们可以使用 `@Select` 注解来定义一个 SELECT 映射语句，如下所示： </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper  </span><br><span class="line">&#123;  </span><br><span class="line">    @Select(&quot;SELECT STUD_ID AS STUDID, NAME, EMAIL, PHONE FROM  </span><br><span class="line">            STUDENTS WHERE STUD_ID=#&#123;studId&#125;&quot;)  </span><br><span class="line">    Student findStudentById(long studId);  </span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">为了将列名和 Student bean 属性名匹配，我们为 stud_id 起了一个 studId 的别名。如果返回了多行结果，将抛出 `TooManyResultsException` 异常。 </span><br><span class="line"></span><br><span class="line">## 结果映射 </span><br><span class="line">我们可以将查询结果通过别名或者是 `@Results` 注解与 JavaBean 属性映射起来。 </span><br><span class="line">现在让我们看看怎样使用 `@Results` 注解将指定列与指定 JavaBean 属性映射器来，执行 SELECT 查询的： </span><br><span class="line">``` </span><br><span class="line">package com.mybatis3.mappers;  </span><br><span class="line">public interface StudentMapper  </span><br><span class="line">&#123;  </span><br><span class="line">    @Select(&quot;SELECT * FROM STUDENTS&quot;)  </span><br><span class="line">    @Results(  </span><br><span class="line">    &#123;  </span><br><span class="line">        @Result(id = true, column = &quot;stud_id&quot;, property = &quot;studId&quot;),  </span><br><span class="line">        @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="line">        @Result(column = &quot;email&quot;, property = &quot;email&quot;),  </span><br><span class="line">        @Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;)  </span><br><span class="line">    &#125;)  </span><br><span class="line">    List&lt;Student&gt; findAllStudents();  </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">&gt; `@Results` 注解和映射器 XML 配置文件元素 `&lt;resultMap&gt;` 相对应，然而，`Mybatis3.2.2` 不能为 `@Results` 注解赋予一个 ID。所以，不像 `&lt;resultMap&gt;` 元素，我们不应该在不同的映射语句中重用 `@Results` 声明。</span><br><span class="line">&gt; 这意味着即使 `@Results` 注解完全相同，我们也需要（在不同的映射接口中）重复 `@Results` 声明。 </span><br><span class="line"></span><br><span class="line">例如，看下面的 findStudentById() 和 findAllStudents() 方法： </span><br><span class="line">``` </span><br><span class="line">@Select(&quot;SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;&quot;)  </span><br><span class="line">@Results(  </span><br><span class="line">&#123;  </span><br><span class="line">    @Result(id = true, column = &quot;stud_id&quot;, property = &quot;studId&quot;),  </span><br><span class="line">    @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="line">    @Result(column = &quot;email&quot;, property = &quot;email&quot;),  </span><br><span class="line">    @Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;)  </span><br><span class="line">&#125;)  </span><br><span class="line">Student findStudentById(int studId);  </span><br><span class="line">    </span><br><span class="line">@Select(&quot;SELECT * FROM STUDENTS&quot;)  </span><br><span class="line">@Results(  </span><br><span class="line">&#123;  </span><br><span class="line">    @Result(id = true, column = &quot;stud_id&quot;, property = &quot;studId&quot;),  </span><br><span class="line">    @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="line">    @Result(column = &quot;email&quot;, property = &quot;email&quot;),  </span><br><span class="line">    @Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;)  </span><br><span class="line">&#125;)  </span><br><span class="line">List&lt;Student&gt; findAllStudents(); </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">这里两个语句的` @Results` 配置完全相同，但是我必须得重复它。这里有一个解决方法。我们可以创建一个映射器 Mapper 配置文件， 然后配置 `&lt;resultMap&gt;` 元素，然后使用 `@ResultMap` 注解引用此 `&lt;resultMap&gt;`。</span><br><span class="line"></span><br><span class="line">在 StudentMapper.xml 中定义一个 ID 为 StudentResult 的 `&lt;resultMap&gt;` ： </span><br><span class="line">``` </span><br><span class="line">&lt;mapper namespace=&quot;com.mybatis3.mappers.StudentMapper&quot;&gt;  </span><br><span class="line">  &lt;resultMap type=&quot;Student&quot; id=&quot;StudentResult&quot;&gt;  </span><br><span class="line">    &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;phone&quot; column=&quot;phone&quot; /&gt;  </span><br><span class="line">  &lt;/resultMap&gt;  </span><br><span class="line">&lt;/mapper&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">在 StudentMapper.java 中，使用 `@ResultMap` 引用名为 StudentResult 的 resultMap： </span><br><span class="line">``` </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    @Select(&quot;SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;&quot;)  </span><br><span class="line">    @ResultMap(&quot;com.mybatis3.mappers.StudentMapper.StudentResult&quot;)  </span><br><span class="line">    Student findStudentById(long studId);  </span><br><span class="line">      </span><br><span class="line">    @Select(&quot;SELECT * FROM STUDENTS&quot;)  </span><br><span class="line">    @ResultMap(&quot;com.mybatis3.mappers.StudentMapper.StudentResult&quot;)  </span><br><span class="line">    List&lt;Student&gt; findAllStudents();  </span><br><span class="line">&#125;  </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 一对一映射 </span><br><span class="line">MyBatis 提供了 `@One` 注解来使用嵌套 select 语句（Nested-Select）加载一对一关联查询数据。让我们看看怎样使 `用@One` 注解获取学生及其地址信息。</span><br><span class="line">``` </span><br><span class="line">public interface StudentMapper &#123;  </span><br><span class="line">    @Select(&quot;SELECT ADDR_ID AS ADDRID, STREET, CITY, STATE, ZIP, COUNTRY  </span><br><span class="line">            FROM ADDRESSES WHERE ADDR_ID=#&#123;id&#125;&quot;)  </span><br><span class="line">    Address findAddressById(long id);  </span><br><span class="line">       </span><br><span class="line">    @Select(&quot;SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125; &quot;)  </span><br><span class="line">    @Results(  </span><br><span class="line">    &#123;  </span><br><span class="line">        @Result(id = true, column = &quot;stud_id&quot;, property = &quot;studId&quot;),  </span><br><span class="line">        @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="line">        @Result(column = &quot;email&quot;, property = &quot;email&quot;),  </span><br><span class="line">        @Result(property = &quot;address&quot;, column = &quot;addr_id&quot;,  </span><br><span class="line">        one = @One(select = &quot;com.mybatis3.mappers.StudentMapper.findAddressById&quot;))  </span><br><span class="line">    &#125;)  </span><br><span class="line">    Student selectStudentWithAddress(long studId);  </span><br><span class="line">&#125; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">这里我们使用了 `@One` 注解的 select 属性来指定一个使用了完全限定名的方法上，该方法会返回一个 Address 对象。使用 `column=”addr_id”` ，则 STUDENTS 表中列 addr_id 的值将会作为输入参数传递给 findAddressById() 方法。如果 `@One` SELECT 查询返回了多行结果，则会抛出 `TooManyResultsException` 异常。</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">long studId = 1;  </span><br><span class="line">StudentMapper studentMapper =   </span><br><span class="line">    sqlSession.getMapper(StudentMapper.class);  </span><br><span class="line">Student student = studentMapper.selectStudentWithAddress(studId);  </span><br><span class="line">System.out.println(&quot;Student :&quot;+student);  </span><br><span class="line">System.out.println(&quot;Address :&quot;+student.getAddress()); </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">在使用 XML 配置 SQL 映射器中，我们可以通过基于 XML 的映射器配置，使用嵌套结果 ResultMap 来加载一对一关联的查询。而 `MyBatis3.2.2` 版本，并没有对应的注解支持。但是我们可以在映射器 Mapper 配置文件中配置 `&lt;resultMap&gt;` 并且使用 `@ResultMap` 注解来引用它。</span><br><span class="line">在 StudentMapper.xml 中配置 `&lt;resultMap&gt;` ，如下所示： </span><br><span class="line">``` </span><br><span class="line">&lt;mapper namespace=&quot;com.mybatis3.mappers.StudentMapper&quot;&gt;  </span><br><span class="line">  &lt;resultMap type=&quot;Address&quot; id=&quot;AddressResult&quot;&gt;  </span><br><span class="line">    &lt;id property=&quot;addrId&quot; column=&quot;addr_id&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  </span><br><span class="line">  &lt;/resultMap&gt;  </span><br><span class="line">  &lt;resultMap type=&quot;Student&quot; id=&quot;StudentWithAddressResult&quot;&gt;  </span><br><span class="line">    &lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;  </span><br><span class="line">    &lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;  </span><br><span class="line">    &lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt;  </span><br><span class="line">  &lt;/resultMap&gt;  </span><br><span class="line">&lt;/mapper&gt; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">public interface StudentMapper  </span><br><span class="line">&#123;  </span><br><span class="line">    @Select(&quot;select stud_id, name, email, a.addr_id, street, city,  </span><br><span class="line">            state, zip, country&quot; + &quot; FROM students s left outer join addresses a  </span><br><span class="line">            on s.addr_id=a.addr_id&quot; + &quot; where stud_id=#&#123;studId&#125; &quot;)  </span><br><span class="line">    @ResultMap(&quot;com.mybatis3.mappers.StudentMapper.  </span><br><span class="line">               StudentWithAddressResult&quot;)  </span><br><span class="line">    Student selectStudentWithAddress(long id);  </span><br><span class="line">&#125; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">### 一对多映射 </span><br><span class="line">MyBatis 提供了 `@Many` 注解，用来使用嵌套 Select 语句加载一对多关联查询。 </span><br><span class="line">现在让我们看一下如何使用 `@Many` 注解获取一个讲师及其教授课程列表信息： </span><br><span class="line">``` </span><br><span class="line">public interface TutorMapper  </span><br><span class="line">&#123;  </span><br><span class="line">    @Select(&quot;select addr_id as addrId, street, city, state, zip,  </span><br><span class="line">            country from addresses where addr_id=#&#123;id&#125;&quot;)  </span><br><span class="line">    Address findAddressById(int id);  </span><br><span class="line">       </span><br><span class="line">    @Select(&quot;select * from courses where tutor_id=#&#123;tutorId&#125;&quot;)  </span><br><span class="line">    @Results(  </span><br><span class="line">    &#123;  </span><br><span class="line">        @Result(id = true, column = &quot;course_id&quot;, property = &quot;courseId&quot;),  </span><br><span class="line">        @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="line">        @Result(column = &quot;description&quot;, property = &quot;description&quot;),  </span><br><span class="line">        @Result(column = &quot;start_date&quot; property = &quot;startDate&quot;),  </span><br><span class="line">        @Result(column = &quot;end_date&quot; property = &quot;endDate&quot;)  </span><br><span class="line">    &#125;)  </span><br><span class="line">    List&lt;Course&gt; findCoursesByTutorId(int tutorId);  </span><br><span class="line">        </span><br><span class="line">    @Select(&quot;SELECT tutor_id, name as tutor_name, email, addr_id  </span><br><span class="line">            FROM tutors where tutor_id=#&#123;tutorId&#125;&quot;)  </span><br><span class="line">    @Results(  </span><br><span class="line">    &#123;  </span><br><span class="line">        @Result(id = true, column = &quot;tutor_id&quot;, property = &quot;tutorId&quot;),  </span><br><span class="line">        @Result(column = &quot;tutor_name&quot;, property = &quot;name&quot;),  </span><br><span class="line">        @Result(column = &quot;email&quot;, property = &quot;email&quot;),  </span><br><span class="line">        @Result(property = &quot;address&quot;, column = &quot;addr_id&quot;,  </span><br><span class="line">        one = @One(select = &quot; com.mybatis3.  </span><br><span class="line">        mappers.TutorMapper.findAddressById&quot;)),  </span><br><span class="line">        @Result(property = &quot;courses&quot;, column = &quot;tutor_id&quot;,  </span><br><span class="line">        many = @Many(select = &quot;com.mybatis3.mappers.TutorMapper.  </span><br><span class="line">        findCoursesByTutorId&quot;))  </span><br><span class="line">    &#125;)  </span><br><span class="line">    Tutor findTutorById(int tutorId);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我们使用了 <code>@Many</code> 注解的 select 属性来指向一个完全限定名称的方法，该方法将返回一个 List<course> 对象。使用 <code>column=”tutor_id”</code> ，TUTORS 表中的 tutor_id 列值将会作为输入参数传递给 findCoursesByTutorId() 方法。</course></p>
<p>使用 XML 配置 SQL 映射器中，我们可以通过基于 XML 的映射器配置，使用嵌套结果 ResultMap 来加载一对多关联的查询。而 <code>MyBatis3.2.2</code> 版本，并没有对应的注解支持。但是我们可以在映射器 Mapper 配置文件中配置 <code>&lt;resultMap&gt;</code> 并且使用 <code>@ResultMap</code> 注解来引用它。<br>在 TutorMapper.xml 中配置 <code>&lt;resultMap&gt;</code> ，如下所示： </p>
<pre><code>&lt;mapper namespace=&quot;com.mybatis3.mappers.TutorMapper&quot;&gt;  
  &lt;resultMap type=&quot;Address&quot; id=&quot;AddressResult&quot;&gt;  
    &lt;id property=&quot;addrId&quot; column=&quot;addr_id&quot; /&gt;  
    &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  
    &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  
    &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  
    &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  
    &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  
  &lt;/resultMap&gt;  
  &lt;resultMap type=&quot;Course&quot; id=&quot;CourseResult&quot;&gt;  
    &lt;id column=&quot;course_id&quot; property=&quot;courseId&quot; /&gt;  
    &lt;result column=&quot;name&quot; property=&quot;name&quot; /&gt;  
    &lt;result column=&quot;description&quot; property=&quot;description&quot; /&gt;  
    &lt;result column=&quot;start_date&quot; property=&quot;startDate&quot; /&gt;  
    &lt;result column=&quot;end_date&quot; property=&quot;endDate&quot; /&gt;  
  &lt;/resultMap&gt;  
  &lt;resultMap type=&quot;Tutor&quot; id=&quot;TutorResult&quot;&gt;  
    &lt;id column=&quot;tutor_id&quot; property=&quot;tutorId&quot; /&gt;  
    &lt;result column=&quot;tutor_name&quot; property=&quot;name&quot; /&gt;  
    &lt;result column=&quot;email&quot; property=&quot;email&quot; /&gt;  
    &lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt;  
    &lt;collection property=&quot;courses&quot; resultMap=&quot;CourseResult&quot; /&gt;  
  &lt;/resultMap&gt;  
&lt;/mapper&gt; </code></pre><pre><code>public interface TutorMapper  
{  
    @Select(&quot;SELECT T.TUTOR_ID, T.NAME AS TUTOR_NAME, EMAIL,  
            A.ADDR_ID, STREET, CITY, STATE, ZIP, COUNTRY, COURSE_ID, C.NAME,  
            DESCRIPTION, START_DATE, END_DATE  FROM TUTORS T LEFT OUTER  
            JOIN ADDRESSES A ON T.ADDR_ID=A.ADDR_ID LEFT OUTER JOIN COURSES  
            C ON T.TUTOR_ID=C.TUTOR_ID WHERE T.TUTOR_ID=#{tutorId}&quot;)  
    @ResultMap(&quot;com.mybatis3.mappers.TutorMapper.TutorResult&quot;)  
    Tutor selectTutorById(int tutorId);  
} </code></pre><h2 id="动态-SQL"><a href="#动态-SQL" class="headerlink" title="动态 SQL"></a>动态 SQL</h2><p>有时候我们需要根据输入条件动态地构建 SQL 语句。MyBatis 提供了各种注解如 <code>@InsertProvider</code> ， <code>@UpdateProvider</code> ， <code>@DeleteProvider</code> 和 <code>@SelectProvider</code> ，来帮助构建动态 SQL 语句，然后让 MyBatis 执行这些 SQL 语句。 </p>
<h3 id="SelectProvider"><a href="#SelectProvider" class="headerlink" title="@SelectProvider"></a>@SelectProvider</h3><p>现在让我们来看一个使用 <code>@SelectProvider</code> 注解来创建一个简单的 SELECT 映射语句的例子。<br>创建一个 TutorDynaSqlProvider.java 类，以及 findTutorByIdSql() 方法，如下所示： </p>
<pre><code>package com.mybatis3.sqlproviders;  
import org.apache.ibatis.jdbc.SQL;  
public class TutorDynaSqlProvider {  
    public String findTutorByIdSql(long tutorId) {  
        return &quot;SELECT TUTOR_ID AS tutorId, NAME, EMAIL FROM TUTORS  
               WHERE TUTOR_ID=&quot; + tutorId;  
    }  
}  </code></pre><p>在 TutorMapper.java 接口中创建一个映射语句，如下： </p>
<pre><code>@SelectProvider(type=TutorDynaSqlProvider.class, method=&quot;findTutorByIdSql&quot;)  
Tutor findTutorById(long tutorId);  </code></pre><p>这里我们使用了 <code>@SelectProvider</code> 来指定了一个类，及其内部的方法，用来提供需要执行的 SQL 语句。 </p>
<p>但是使用字符串拼接的方法来构建 SQL 语句是非常困难的，并且容易出错。所以MyBaits提供了一个SQL工具类不使用字符串拼接的方式，简化构造动态SQL语句。</p>
<p>现在，让我们看看如何使用 <code>org.apache.ibatis.jdbc.SQL</code> 工具类来准备相同的 SQL 语句： </p>
<pre><code>package com.mybatis3.sqlproviders;  
import org.apache.ibatis.jdbc.SQL;  
public class TutorDynaSqlProvider {  
    public String findTutorByIdSql(final long tutorId) {  
        return new SQL() 
        {  
            {  
                SELECT(&quot;tutor_id as tutorId, name, email&quot;);  
                FROM(&quot;tutors&quot;);  
                WHERE(&quot;tutor_id=&quot; + tutorId);  
            }  
        }.toString();  
    }  
}</code></pre><p>SQ L工具类会处理以合适的空格前缀和后缀来构造 SQL 语句。</p>
<p>动态 SQL provider 方法可以接收以下其中一种参数： </p>
<ul>
<li>无参数 </li>
<li>和映射器 Mapper 接口的方法同类型的参数 </li>
<li><code>java.util.Map</code> </li>
</ul>
<h4 id="使用不带参数的-SQL-Provider"><a href="#使用不带参数的-SQL-Provider" class="headerlink" title="使用不带参数的 SQL Provider"></a>使用不带参数的 SQL Provider</h4><pre><code>public String findTutorByIdSql()  
{  
    return new SQL()  
    {  
        {  
            SELECT(&quot;tutor_id as tutorId, name, email&quot;);  
            FROM(&quot;tutors&quot;);  
            WHERE(&quot;tutor_id = #{tutorId}&quot;);  
        }  
    }.toString();  
}  </code></pre><p>这里我们没有使用输入参数构造 SQL 语句，所以它可以是一个无参方法。 </p>
<h4 id="使用和映射器-Mapper-接口的方法同类型的参数"><a href="#使用和映射器-Mapper-接口的方法同类型的参数" class="headerlink" title="使用和映射器 Mapper 接口的方法同类型的参数"></a>使用和映射器 Mapper 接口的方法同类型的参数</h4><p>如果映射器 Mapper 接口方法只有一个参数，那么可以定义 SQL Provider 方法，它接受一个与 Mapper 接口方法相同类型的参数。<br>例如映射器 Mapper 接口有如下定义： </p>
<pre><code>Tutor findTutorById(long tutorId); </code></pre><p>这里 findTutorById(int) 方法只有一个 long 类型的参数。我们可以定义 findTutorByIdSql(long) 方法作为 SQL provider 方法： </p>
<pre><code>public String findTutorByIdSql(final long tutorId)  
{  
    return new SQL()  
    {  
        {  
            SELECT(&quot;tutor_id as tutorId, name, email&quot;);  
            FROM(&quot;tutors&quot;);  
            WHERE(&quot;tutor_id=&quot; + tutorId);  
        }  
    }.toString();  
} </code></pre><h4 id="使用-java-util-Map-参数类型的-SQL-Provider"><a href="#使用-java-util-Map-参数类型的-SQL-Provider" class="headerlink" title="使用 java.util.Map 参数类型的 SQL Provider"></a>使用 <code>java.util.Map</code> 参数类型的 SQL Provider</h4><p>如果映射器 Mapper 接口有多个输入参数，我们可以使用参数类型为 <code>java.util.Map</code> 的方法作为 SQL Provider 方法。然后映射器 Mapper 接口方法所有的输入参数将会被放到 map 中，以 param1，param2 等等作为 key，将输入参数按序作为 value。你也可以使用 0，1，2 等作为 key 值来取的输入参数： </p>
<pre><code>@SelectProvider(type = TutorDynaSqlProvider.class,  
                method = &quot;findTutorByNameAndEmailSql&quot;)  
Tutor findTutorByNameAndEmail(String name, String email);  

public String findTutorByNameAndEmailSql(Map&lt;String, Object&gt; map) {  
    String name = (String) map.get(&quot;param1&quot;);  
    String email = (String) map.get(&quot;param2&quot;);  
    //you can also get those values using 0,1 keys  
    //String name = (String) map.get(&quot;0&quot;);  
    //String email = (String) map.get(&quot;1&quot;);  
    return new SQL()  
    {  
        {  
            SELECT(&quot;tutor_id as tutorId, name, email&quot;);  
            FROM(&quot;tutors&quot;);  
            WHERE(&quot;name=#{name} AND email=#{email}&quot;);  
        }  
    }.toString();  
} </code></pre><p>SQL 工具类也提供了其他的方法来表示 <code>JOINS</code> ， <code>ORDER_BY</code> ， <code>GROUP_BY</code> 等等。<br>让我们看一个使用 <code>LEFT_OUTER_JOIN</code> 的例子： </p>
<pre><code>public class TutorDynaSqlProvider {  
    public String selectTutorById() {  
        return new SQL()  
        {  
            {  
                SELECT(&quot;t.tutor_id, t.name as tutor_name, email&quot;);  
                SELECT(&quot;a.addr_id, street, city, state, zip, country&quot;);  
                SELECT(&quot;course_id, c.name as course_name, description,  
                       start_date, end_date&quot;);  
                FROM(&quot;TUTORS t&quot;);  
                LEFT_OUTER_JOIN(&quot;addresses a on t.addr_id=a.addr_id&quot;);  
                LEFT_OUTER_JOIN(&quot;courses c on t.tutor_id=c.tutor_id&quot;);  
                WHERE(&quot;t.TUTOR_ID = #{id}&quot;);  
            }  
        }.toString();  
    }  
}  

public interface TutorMapper {  
    @SelectProvider(type = TutorDynaSqlProvider.class,  
                    method = &quot;selectTutorById&quot;)  
    @ResultMap(&quot;com.mybatis3.mappers.TutorMapper.TutorResult&quot;)  
    Tutor selectTutorById(int tutorId);  
} </code></pre><p>由于没有支持使用内嵌结果 ResultMap 的一对多关联映射的注解支持，我们可以使用基于 XML 的 <code>&lt;resultMap&gt;</code> 配置，然后与 <code>@ResultMap</code> 映射： </p>
<pre><code>&lt;mapper namespace=&quot;com.mybatis3.mappers.TutorMapper&quot;&gt;  
  &lt;resultMap type=&quot;Address&quot; id=&quot;AddressResult&quot;&gt;  
    &lt;id property=&quot;id&quot; column=&quot;addr_id&quot; /&gt;  
    &lt;result property=&quot;street&quot; column=&quot;street&quot; /&gt;  
    &lt;result property=&quot;city&quot; column=&quot;city&quot; /&gt;  
    &lt;result property=&quot;state&quot; column=&quot;state&quot; /&gt;  
    &lt;result property=&quot;zip&quot; column=&quot;zip&quot; /&gt;  
    &lt;result property=&quot;country&quot; column=&quot;country&quot; /&gt;  
  &lt;/resultMap&gt;  
  &lt;resultMap type=&quot;Course&quot; id=&quot;CourseResult&quot;&gt;  
    &lt;id column=&quot;course_id&quot; property=&quot;id&quot; /&gt;  
    &lt;result column=&quot;course_name&quot; property=&quot;name&quot; /&gt;  
    &lt;result column=&quot;description&quot; property=&quot;description&quot; /&gt;  
    &lt;result column=&quot;start_date&quot; property=&quot;startDate&quot; /&gt;  
    &lt;result column=&quot;end_date&quot; property=&quot;endDate&quot; /&gt;  
  &lt;/resultMap&gt;  
  &lt;resultMap type=&quot;Tutor&quot; id=&quot;TutorResult&quot;&gt;  
    &lt;id column=&quot;tutor_id&quot; property=&quot;id&quot; /&gt;  
    &lt;result column=&quot;tutor_name&quot; property=&quot;name&quot; /&gt;  
    &lt;result column=&quot;email&quot; property=&quot;email&quot; /&gt;  
    &lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt;  
    &lt;collection property=&quot;courses&quot; resultMap=&quot;CourseResult&quot;&gt;&lt;/collection&gt;  
  &lt;/resultMap&gt;  
&lt;/mapper&gt;  </code></pre><h3 id="InsertProvider"><a href="#InsertProvider" class="headerlink" title="@InsertProvider"></a>@InsertProvider</h3><p>我们可以使用 <code>@InsertProvider</code> 注解创建动态的 INSERT 语句，如下所示： </p>
<pre><code>public class TutorDynaSqlProvider {  
    public String insertTutor(final Tutor tutor) {  
        return new SQL()  
        {  
            {  
                INSERT_INTO(&quot;TUTORS&quot;);  
                if (tutor.getName() != null)  
                {  
                    VALUES(&quot;NAME&quot;, &quot;#{name}&quot;);  
                }  
                if (tutor.getEmail() != null)  
                {  
                    VALUES(&quot;EMAIL&quot;, &quot;#{email}&quot;);  
                }  
            }  
        }.toString();  
    }  
}   

public interface TutorMapper {  
    @InsertProvider(type = TutorDynaSqlProvider.class,  
                    method = &quot;insertTutor&quot;)  
    @Options(useGeneratedKeys = true, keyProperty = &quot;tutorId&quot;)  
    int insertTutor(Tutor tutor);  
} </code></pre><h3 id="UpdateProvider"><a href="#UpdateProvider" class="headerlink" title="@UpdateProvider"></a>@UpdateProvider</h3><p>我们可以通过 <code>@UpdateProvider</code> 注解创建 UPDATE 语句，如下所示： </p>
<pre><code>public class TutorDynaSqlProvider {  
    public String updateTutor(final Tutor tutor) {  
        return new SQL()  
        {  
            {  
                UPDATE(&quot;TUTORS&quot;);  
                if (tutor.getName() != null)  
                {  
                    SET(&quot;NAME = #{name}&quot;);  
                }  
                if (tutor.getEmail() != null)  
                {  
                    SET(&quot;EMAIL = #{email}&quot;);  
                }  
                WHERE(&quot;TUTOR_ID = #{tutorId}&quot;);  
            }  
        }.toString();  
    }  
}   

public interface TutorMapper {  
    @UpdateProvider(type = TutorDynaSqlProvider.class,  
                    method = &quot;updateTutor&quot;)  
    int updateTutor(Tutor tutor);  
}</code></pre><h3 id="DeleteProvider"><a href="#DeleteProvider" class="headerlink" title="@DeleteProvider"></a>@DeleteProvider</h3><p>我们可以使用 <code>@DeleteProvider</code> 注解创建动态地 DELETE 语句,如下所示： </p>
<pre><code>public class TutorDynaSqlProvider {  
    public String deleteTutor(long tutorId) {  
        return new SQL()  
        {  
            {  
                DELETE_FROM(&quot;TUTORS&quot;);  
                WHERE(&quot;TUTOR_ID = #{tutorId}&quot;);  
            }  
        } .toString();  
    }  
}  

public interface TutorMapper {  
    @DeleteProvider(type = TutorDynaSqlProvider.class,  
                    method = &quot;deleteTutor&quot;)  
    int deleteTutor(long tutorId);  
}  </code></pre><blockquote>
<p><a href="http://blog.csdn.net/luanlouis/article/details/35780175" target="_blank" rel="noopener">Java Persistence with MyBatis 3(中文版) 第四章 使用注解配置SQL映射器</a></p>
</blockquote>

            <div class="post-button text-center">
              <a class="btn" href="/2018/01/08/mybatis-2018-01-08-Mybatis-使用注解配置SQL映射器/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">01月</div>
			<div class="post-day">05</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Java/" itemprop="url" rel="index">
          <span itemprop="name">Java</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2018/01/05/java-2018-01-05-Difference-between-Comparator-and-Comparable-in-Java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/05/java-2018-01-05-Difference-between-Comparator-and-Comparable-in-Java/" itemprop="url">Difference between Comparator and Comparable in Java</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-05T00:00:00+08:00">
                2018-01-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p><a href="https://www.javacodegeeks.com/2013/03/difference-between-comparator-and-comparable-in-java.html" target="_blank" rel="noopener">Difference between Comparator and Comparable in Java</a> </p>
</blockquote>
<p>One of the common interview question is ‘What are differences between Comparator and Comparable’. or ‘How will you sort collection of employee objects by its id or name’.For that we can use two interfaces.i.e. Comparator and Comparable.Before we actually see differences,let me give you brief introduction of both. </p>
<p>Comparable interface: Class whose objects to be sorted must implement this interface.In this,we have to implement compareTo(Object) method. </p>
<p>For example: </p>
<pre><code>public class Country implements Comparable {
    @Override
    public int compareTo(Object arg0) {
        Country country=(Country) arg0;
        return (this.countryId &lt; country.countryId ) ? -1: (this.countryId &gt; country.countryId ) ? 1:0 ;
}} </code></pre><p>If any class implements comparable inteface then collection of that object can be sorted automatically using Collection.sort() or Arrays.sort().Object will be sort on the basis of compareTo method in that class.</p>
<p>Objects which implement Comparable in java can be used as keys in a SortedMap like TreeMap or SortedSet like TreeSet without implementing any other interface.</p>
<p>Comparator interface: Class whose objects to be sorted do not need to implement this interface.Some third class can implement this interface to sort.e.g.CountrySortByIdComparator class can implement Comparator interface to sort collection of country object by id. For example: </p>
<pre><code>public class CountrySortByIdComparator implements Comparator&lt;Country&gt; {
    @Override
    public int compare(Country country1, Country country2) {
        return (country1.getCountryId() &lt; country2.getCountryId() ) ? -1: (country1.getCountryId() &gt; country2.getCountryId() ) ? 1:0 ;
    }
}</code></pre><p>Using Comparator interface,we can write different sorting based on different attributes of objects to be sorted.You can use anonymous comparator to compare at particular line of code. For example: </p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/05/java-2018-01-05-Difference-between-Comparator-and-Comparable-in-Java/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">12月</div>
			<div class="post-day">20</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Java/" itemprop="url" rel="index">
          <span itemprop="name">Java</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2017/12/20/java-2017-12-20-Java8-Date-Time-API/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/20/java-2017-12-20-Java8-Date-Time-API/" itemprop="url">Java 8 日期/时间（Date Time）API指南</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-20T00:00:00+08:00">
                2017-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>转载自 <a href="http://www.codeceo.com/article/java-8-date-time-api.html" target="_blank" rel="noopener">http://www.codeceo.com/article/java-8-date-time-api.html</a>  </p>
</blockquote>
<h3 id="为什么我们需要新的Java日期-时间API？"><a href="#为什么我们需要新的Java日期-时间API？" class="headerlink" title="为什么我们需要新的Java日期/时间API？"></a>为什么我们需要新的Java日期/时间API？</h3><p>在开始研究Java 8日期/时间API之前，让我们先来看一下为什么我们需要这样一个新的API。在Java中，现有的与日期和时间相关的类存在诸多问题，其中有： </p>
<ol>
<li>Java的日期/时间类的定义并不一致，在java.util和java.sql的包中都有日期类，此外用于格式化和解析的类在java.text包中定义。</li>
<li>java.util.Date同时包含日期和时间，而java.sql.Date仅包含日期，将其纳入java.sql包并不合理。另外这两个类都有相同的名字，这本身就是一个非常糟糕的设计。</li>
<li>对于时间、时间戳、格式化以及解析，并没有一些明确定义的类。对于格式化和解析的需求，我们有java.text.DateFormat抽象类，但通常情况下，SimpleDateFormat类被用于此类需求。</li>
<li>所有的日期类都是可变的，因此他们都不是线程安全的，这是Java日期类最大的问题之一。</li>
<li>日期类并不提供国际化，没有时区支持，因此Java引入了java.util.Calendar和java.util.TimeZone类，但他们同样存在上述所有的问题。 </li>
</ol>
<p>在现有的日期和日历类中定义的方法还存在一些其他的问题，但以上问题已经很清晰地表明：Java需要一个健壮的日期/时间类。这也是为什么Joda Time在Java日期/时间需求中扮演了高质量替换的重要角色。 </p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/12/20/java-2017-12-20-Java8-Date-Time-API/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">12月</div>
			<div class="post-day">05</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Spring/" itemprop="url" rel="index">
          <span itemprop="name">Spring</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2017/12/05/spring-2017-12-05-Spring-Validation-i18n/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/05/spring-2017-12-05-Spring-Validation-i18n/" itemprop="url">Spring 验证和国际化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-05T00:00:00+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="Validator-国际化"><a href="#Validator-国际化" class="headerlink" title="Validator 国际化"></a>Validator 国际化</h3><blockquote>
<p><a href="http://www.jianshu.com/p/b7fd2279e5cb" target="_blank" rel="noopener">SpringMVC表单验证器</a></p>
</blockquote>
<p>在 ProductCommand 类中添加 name 属性的验证： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Size(min = 1, max = 10)</span><br><span class="line">@Pattern(regexp = &quot;^[\\u4e00-\\u9fa5]*$&quot;)</span><br><span class="line">private String name;</span><br><span class="line">``` </span><br><span class="line">当验证不通过时会产生默认的错误信息，如上面的验证分别会产生下面的两条默认错误信息： </span><br><span class="line">```  </span><br><span class="line">个数必须在1和10之间 </span><br><span class="line">需要匹配正则表达式&quot;^[\u4e00-\u9fa5]*$&quot; </span><br><span class="line">``` </span><br><span class="line">也可以在注解上面加上自定义的默认错误信息，例如在 @Pattern 注解上加上默认错误信息：</span><br><span class="line">``` </span><br><span class="line">@Size(min = 1, max = 10)</span><br><span class="line">@Pattern(regexp = &quot;^[\\u4e00-\\u9fa5]*$&quot;, message = &quot;产品名称格式不正确&quot;)</span><br><span class="line">private String name;</span><br><span class="line">``` </span><br><span class="line">这样如果 name 属性值不匹配正则的话就会显示：</span><br><span class="line">```  </span><br><span class="line">产品名称格式不正确</span><br></pre></td></tr></table></figure>

<p>还可以将默认错误信息国际化：</p>
<pre><code>@Size(min = 1, max = 10)
@Pattern(regexp = &quot;^[\\u4e00-\\u9fa5]*$&quot;, message = &quot;{product.name.pattern}&quot;)
private String name;</code></pre><p>在项目 resources 目录下新建类似<code>ValidationMessages_xx.properties</code> 文件名的国际化文件，如<code>ValidationMessages_zh_CN.properties</code>表示中文国际化文件。 在<code>ValidationMessages_zh_CN.properties</code> 文件中将<code>product.name.pattern</code> 配置相对应的错误信息： </p>
<pre><code># 产品名称格式不正确
product.name.pattern=\u4ea7\u54c1\u540d\u79f0\u683c\u5f0f\u4e0d\u6b63\u786e</code></pre><p>国际化文件里面要将中文转成Unicode（<a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">Unicode编码转换</a>），不然显示时会乱码。 </p>
<p>使用 SpringBoot，spring-boot-starter-web 会自动引入hiberante-validator, validation-api 依赖。</p>
<p>因为 Spring 的国际化默认是以 <code>messages</code> 开头的（org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration），而上面的修改会将所有的国际化文件都指示以 <code>ValidationMessages</code> 开头，所以为了避免冲突，都以 <code>messages</code> 开头。</p>
<p>SpringBoot 默认的国际化文件的 <code>baseName</code> 是 <code>i18n/messages</code>，所以将验证信息的国际化放在 <code>i18n/messages</code> 里也可以。 </p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/12/05/spring-2017-12-05-Spring-Validation-i18n/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">12月</div>
			<div class="post-day">02</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Go/" itemprop="url" rel="index">
          <span itemprop="name">Go</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuchao.github.io/2017/12/02/go-2017-12-02-Golang-install-and-configuration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuchao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/DIYgod.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keep Coding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/02/go-2017-12-02-Golang-install-and-configuration/" itemprop="url">Go 语言的安装和配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-02T00:00:00+08:00">
                2017-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="安装和配置"><a href="#安装和配置" class="headerlink" title="安装和配置"></a>安装和配置</h3><h4 id="下载安装包，由于官网需要访问不了，所以可以到-Go-语言中文网（https-studygolang-com-dl）下载安装包。"><a href="#下载安装包，由于官网需要访问不了，所以可以到-Go-语言中文网（https-studygolang-com-dl）下载安装包。" class="headerlink" title="下载安装包，由于官网需要访问不了，所以可以到 Go 语言中文网（https://studygolang.com/dl）下载安装包。"></a>下载安装包，由于官网需要访问不了，所以可以到 Go 语言中文网（<a href="https://studygolang.com/dl）下载安装包。" target="_blank" rel="noopener">https://studygolang.com/dl）下载安装包。</a></h4><h4 id="将下载的源码包解压至-usr-local目录。"><a href="#将下载的源码包解压至-usr-local目录。" class="headerlink" title="将下载的源码包解压至 /usr/local目录。"></a>将下载的源码包解压至 /usr/local目录。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar -C /usr/local -xzf go1.9.2.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>

<p>解压完成后，在 /usr/local 目录下生成 go 目录。 </p>
<h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><pre><code>$ vim /etc/profile </code></pre><p>将 /usr/local/go/bin 目录加入至 PATH 环境变量 </p>
<pre><code>export GOROOT=/usr/local/go
export PATH=$PATH:$GOROOT/bin </code></pre><p>编译生效</p>
<pre><code>$ source /etc/profile </code></pre><h4 id="验证-Go-环境配置成功"><a href="#验证-Go-环境配置成功" class="headerlink" title="验证 Go 环境配置成功"></a>验证 Go 环境配置成功</h4><pre><code>$ go version </code></pre><p>如果正确打印出 Go 语言版本号，则表示安装和配置成功：</p>
<pre><code>go version go1.9.2 linux/amd64 </code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/12/02/go-2017-12-02-Golang-install-and-configuration/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    

    <footer class="post-footer">
      

      

      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          



  

    

  




	





  















        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/card.jpg" alt="wuchao">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/wuchao" target="_blank" title="GitHub" data-balloon="GitHub" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="wu94726@gmail.com" target="_blank" title="邮箱" data-balloon="邮箱" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-email"></i></a>
                </span>
              
            
          </div>

          

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            
            

          </nav>

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.png" alt="Creative Commons">
              </a>
            </div>
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-image"></div>
      <div class="footer-inner">
        <p>博客已萌萌哒运行<span id="since"></span><span class="my-face">(●'◡'●)ﾉ♥</span></p>
<p></p>

<p>© <span itemprop="copyrightYear">2019</span> Keep Coding.
    由 <a href="https://hexo.io/" target="_blank" class="external" rel="nofollow">Hexo</a> 强力驱动.
    Theme By <a href="https://github.com/DIYgod/hexo-theme-sagiri" target="_blank" class="external" rel="nofollow">Sagiri</a> v0.0.4.
    
</p>
<p>Made with <i class="fa fa-heart throb" style="color: #d43f57;"></i> by <span class="author" itemprop="copyrightHolder">wuchao</span>. </p>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    <canvas id="evanyou" style="display:none;"></canvas>
    <canvas id="live2d" width="150" height="400" class="live2d" style="display:none;"></canvas>

    

  </div>

  <script type="text/javascript" src="/js/sagiri.min.js?v=0.0.4"></script>

  





  

  
  

  

  

  

</body>
</html>
